---
title: "R Notebook"
output: html_notebook
---

This notebook is used to extract data from original data files in the Excel format. Because the file format changes over time, each year is done separately. 

```{r setup}
rm(list=ls())
library(tidyverse)
library(lubridate)
library(readxl)
source("Piedras_Blancas_fcns.R")

data.dir <- "data/All data/"
out.dir <- "data/Processed data/"
```


## 1994

```{r}
Year <- 1994
dir.name <- paste0("C_C ", Year)
start.time <- "630"
xls.files <- list.files(path = paste0(data.dir, dir.name), pattern = ".xls")
xls.file.name.inshore <- paste0(data.dir, dir.name, "/", xls.files[1])
xls.file.name.offshore <- paste0(data.dir, dir.name, "/", xls.files[2])

sheet.name.inshore <- "INSHORE LOG"
sheet.name.offshore <- NULL
col.types.inshore <- c("date", "numeric", "text", "numeric", "numeric",
                       "numeric", "numeric", "text", "text")

col.names.inshore <- c("Date", "Event", "Time", "Obs. Code", "Sea State",
                       "Vis. IN", "Cow  / Calf")

col.types.offshore <- c("date", "numeric", "text", "numeric", "numeric",
                        "numeric", "numeric", "numeric", "text", "text")

col.names.offshore <- c("Date", "Event", "Time", "Obs.", "Sea State",
                        "Vis. Code", "Cow/Calf", "Ad./Juv.")

data.list <- get.all.data(sheet.name.inshore, sheet.name.offshore,
                          col.types.inshore, col.types.offshore,
                          col.names.inshore, col.names.offshore,
                          Year, dir.name, 
                          xls.file.name.inshore, xls.file.name.offshore,
                          start.time)

out.file.name.all <- paste0(out.dir, "Processed_all_data_", 
                            Year, ".csv")
out.file.name.shift <- paste0(out.dir, "Processed_by_shift_data_", 
                              Year, ".csv")

if (!file.exists(out.file.name.all))
  write_csv(data.list$all,
            file = out.file.name.all)

if (!file.exists(out.file.name.shift))
  write_csv(data.list$shift,
            file = out.file.name.shift)


```


## 1995

```{r}
Year <- 1995
dir.name <- paste0("C_C ", Year)
start.time <- "700"
xls.files <- list.files(path = paste0(data.dir, dir.name), pattern = ".xls")
xls.file.name.inshore <- paste0(data.dir, dir.name, "/", xls.files[1])
xls.file.name.offshore <- paste0(data.dir, dir.name, "/", xls.files[2])

sheet.name.inshore <- "Inshore Data"
sheet.name.offshore <- "Offshore Data"
col.types.inshore <- c("date", "numeric", "text", "numeric", "numeric", 
                       "numeric", "numeric", "numeric", "text", "text", 
                       "text", "text", "text", "text", "text", "text")

col.names.inshore <- c("Date",	"Event Code",	"Time",	"Observer Code",	
                       "Sea State",	"Vis In",	"C/C Pairs")

col.types.offshore <- c("date", "numeric", "text", "numeric", 
                        "numeric", "numeric", "numeric", "numeric", 
                        "numeric", "numeric", "numeric", "text")


col.names.offshore <- c("Date",	"Event",	"Time",	"OBS.",
                        "Sea",	"Vis.",	"Cow/Calf")

data.list <- get.all.data(sheet.name.inshore, sheet.name.offshore,
                          col.types.inshore, col.types.offshore,
                          col.names.inshore, col.names.offshore,
                          Year, dir.name, 
                          xls.file.name.inshore, xls.file.name.offshore,
                          start.time)

out.file.name.all <- paste0(out.dir, "Processed_all_data_", 
                            Year, ".csv")
out.file.name.shift <- paste0(out.dir, "Processed_by_shift_data_", 
                              Year, ".csv")

if (!file.exists(out.file.name.all))
  write_csv(data.list$all,
            file = out.file.name.all)

if (!file.exists(out.file.name.shift))
  write_csv(data.list$shift,
            file = out.file.name.shift)


```



## 1996

```{r}
Year <- 1996
dir.name <- paste0("C_C ", Year)
start.time <- "700"
xls.files <- list.files(path = paste0(data.dir, dir.name), pattern = ".xls")
xls.file.name.inshore <- paste0(data.dir, dir.name, "/", xls.files[1])
xls.file.name.offshore <- paste0(data.dir, dir.name, "/", xls.files[2])

sheet.name.inshore <- "data"
sheet.name.offshore <- "Sheet1"
col.names.inshore <- c("DATE",	"EVENT CODE",	"TIME", "OBS.",	
                       "SEA STATE",	"VIS (IN/OUT)",	"C/C")

col.types.inshore <- c("date", "numeric", "text", "numeric", 
                       "numeric", "text", "numeric", "numeric", 
                       "numeric", "text", "text", "text", 
                       "text", "text")

col.names.offshore <- c("DATE",	"EVENT CODE",	"TIME", 	"OBS",
                        "VIS",	"SEA ST.",	"C/C")

col.types.offshore <- c("date", "numeric", "text", "numeric", 
                        "numeric", "numeric", "numeric", "numeric", 
                        "numeric", "text",  "text")


data.list <- get.all.data(sheet.name.inshore, sheet.name.offshore,
                          col.types.inshore, col.types.offshore,
                          col.names.inshore, col.names.offshore,
                          Year, dir.name, 
                          xls.file.name.inshore, xls.file.name.offshore,
                          start.time)

out.file.name.all <- paste0(out.dir, "Processed_all_data_", 
                            Year, ".csv")
out.file.name.shift <- paste0(out.dir, "Processed_by_shift_data_", 
                              Year, ".csv")

if (!file.exists(out.file.name.all))
  write_csv(data.list$all,
            file = out.file.name.all)

if (!file.exists(out.file.name.shift))
  write_csv(data.list$shift,
            file = out.file.name.shift)


```



## 1997

```{r}
Year <- 1997
dir.name <- paste0("C_C ", Year)
start.time <- "630"
xls.files <- list.files(path = paste0(data.dir, dir.name), pattern = ".xls")
xls.file.name.inshore <- paste0(data.dir, dir.name, "/", xls.files[1])
xls.file.name.offshore <- paste0(data.dir, dir.name, "/", xls.files[2])

sheet.name.inshore <- "LOGS"
sheet.name.offshore <- "LOGS"

col.names.inshore <- c("DATE",	"EVENT",	"TIME",	"OBSER" ,	
                       "VIS I/O",	"SEA STATE", "C/C")

col.types.inshore <- c("date", "numeric", "text", "numeric", 
                       "numeric", "numeric", "text", "text", 
                       "text", "text", "text", "text", 
                       "text", "text")

col.names.offshore <- c("DATE",	"EVENT CODE",	"TIME", "OBS",
                        "VIS", "S STATE",	"COW/CA")

col.types.offshore <- c("date", "numeric", "text", "numeric", 
                        "numeric", "text", "text", "numeric", 
                        "text", "text",  "numeric", "text")


data.list <- get.all.data(sheet.name.inshore, sheet.name.offshore,
                          col.types.inshore, col.types.offshore,
                          col.names.inshore, col.names.offshore,
                          Year, dir.name, 
                          xls.file.name.inshore, xls.file.name.offshore,
                          start.time)

out.file.name.all <- paste0(out.dir, "Processed_all_data_", 
                            Year, ".csv")
out.file.name.shift <- paste0(out.dir, "Processed_by_shift_data_", 
                              Year, ".csv")

if (!file.exists(out.file.name.all))
  write_csv(data.list$all,
            file = out.file.name.all)

if (!file.exists(out.file.name.shift))
  write_csv(data.list$shift,
            file = out.file.name.shift)


```



## 1998

```{r}
Year <- 1998
dir.name <- paste0("C_C ", Year)
start.time <- "630"
xls.files <- list.files(path = paste0(data.dir, dir.name), pattern = ".xls")
xls.file.name.inshore <- paste0(data.dir, dir.name, "/", xls.files[1])
xls.file.name.offshore <- paste0(data.dir, dir.name, "/", xls.files[2])

sheet.name.inshore <- "LOG"
sheet.name.offshore <- "LOGS"

col.names.inshore <- c("Date",	"Event Code",	"Time",	"Obs",
                       "Vis (I/O)", "Sea State",	"c/c"	)

col.types.inshore <- c("date", "numeric", "text", "numeric", 
                       "numeric", "text", "numeric", "numeric", 
                       "numeric", "text", "text", "text", 
                       "text", "text")

col.names.offshore <- c("Date",	"Event Code",	"Time",	"Obs",	
                        "Vis",	"SeaState",	"c/c")

col.types.offshore <- c("date", "numeric", "text", "numeric", 
                        "numeric", "text", "numeric", "numeric", 
                        "text", "text",  "text", "text")


data.list <- get.all.data(sheet.name.inshore, sheet.name.offshore,
                          col.types.inshore, col.types.offshore,
                          col.names.inshore, col.names.offshore,
                          Year, dir.name, 
                          xls.file.name.inshore, xls.file.name.offshore,
                          start.time)

out.file.name.all <- paste0(out.dir, "Processed_all_data_", 
                            Year, ".csv")
out.file.name.shift <- paste0(out.dir, "Processed_by_shift_data_", 
                              Year, ".csv")

if (!file.exists(out.file.name.all))
  write_csv(data.list$all,
            file = out.file.name.all)

if (!file.exists(out.file.name.shift))
  write_csv(data.list$shift,
            file = out.file.name.shift)


```




## 1999

```{r}
Year <- 1999
dir.name <- paste0("C_C ", Year)
start.time <- "630"
xls.files <- list.files(path = paste0(data.dir, dir.name), pattern = ".xls")
xls.file.name.inshore <- paste0(data.dir, dir.name, "/", xls.files[1])
xls.file.name.offshore <- paste0(data.dir, dir.name, "/", xls.files[2])

sheet.name.inshore <- "DATA"
sheet.name.offshore <- "DATA"

col.names.inshore <- c("Date",	"Event Code",	"Time", 	"Obs. Code",
                       "Vis", "Sea State", "C/C")

col.types.inshore <- c("date", "numeric", "text", "numeric", 
                       "numeric", "text", "numeric", "numeric", 
                       "numeric", "text", "text", "text",
                       "text", "text", "text")

# data.out <- read_excel(xls.file.name.inshore,
#                          sheet = sheet.name.inshore,
#                          col_types = col.types.inshore)
#                        
# data.inshore <- get.data(Year = Year,
#                            dir.name = dir.name,
#                            xls.file.name = xls.file.name.inshore,
#                            sheet.name = sheet.name.inshore,
#                            col.types = col.types.inshore,
#                            col.names = col.names.inshore,
#                            area.name = "inshore",
#                            start.time = start.time)

col.names.offshore <- c("Date",	"Event Code",	"Time",	"Observer",	
                        "Vis. Code",	"Sea State",	"C/C")

col.types.offshore <- c("date", "numeric", "text", "numeric", 
                        "numeric", "text", "numeric", "numeric", 
                        "text", "text",  "text", "text")


data.list <- get.all.data(sheet.name.inshore, sheet.name.offshore,
                          col.types.inshore, col.types.offshore,
                          col.names.inshore, col.names.offshore,
                          Year, dir.name, 
                          xls.file.name.inshore, xls.file.name.offshore,
                          start.time)

out.file.name.all <- paste0(out.dir, "Processed_all_data_", 
                            Year, ".csv")
out.file.name.shift <- paste0(out.dir, "Processed_by_shift_data_", 
                              Year, ".csv")

if (!file.exists(out.file.name.all))
  write_csv(data.list$all,
            file = out.file.name.all)

if (!file.exists(out.file.name.shift))
  write_csv(data.list$shift,
            file = out.file.name.shift)


```



## 2000

```{r}
Year <- 2000
dir.name <- paste0("C_C ", Year)
start.time <- "630"
xls.files <- list.files(path = paste0(data.dir, dir.name), pattern = ".xls")
xls.file.name.inshore <- paste0(data.dir, dir.name, "/", xls.files[1])
xls.file.name.offshore <- paste0(data.dir, dir.name, "/", xls.files[2])

sheet.name.inshore <- "DATA"
sheet.name.offshore <- "LOGS"

col.names.inshore <- c("DATE",	"EVENT",	"TIME",	"OBS.",	
                       "VIS (IN/OUT)",	"SEA STATE",	"C/C")

col.types.inshore <- c("date", "numeric", "text", "numeric", 
                       "numeric", "text", "numeric", "numeric", 
                       "text", "text", "text", "text",
                       "text", "text")

# data.out <- read_excel(xls.file.name.inshore,
#                          sheet = sheet.name.inshore,
#                          col_types = col.types.inshore)
#                        
# data.inshore <- get.data(Year = Year,
#                            dir.name = dir.name,
#                            xls.file.name = xls.file.name.inshore,
#                            sheet.name = sheet.name.inshore,
#                            col.types = col.types.inshore,
#                            col.names = col.names.inshore,
#                            area.name = "inshore",
#                            start.time = start.time)

col.names.offshore <- c("DATE",	"EVENT",	"TIME",	"OBS.",
                        "VIS CODE",	"SEA STATE",	"C/C")

col.types.offshore <- c("date", "numeric", "text", "numeric", 
                        "numeric", "text", "numeric", "numeric", 
                        "text", "text",  "text")


data.list <- get.all.data(sheet.name.inshore, sheet.name.offshore,
                          col.types.inshore, col.types.offshore,
                          col.names.inshore, col.names.offshore,
                          Year, dir.name, 
                          xls.file.name.inshore, xls.file.name.offshore,
                          start.time)

out.file.name.all <- paste0(out.dir, "Processed_all_data_", 
                            Year, ".csv")
out.file.name.shift <- paste0(out.dir, "Processed_by_shift_data_", 
                              Year, ".csv")

if (!file.exists(out.file.name.all))
  write_csv(data.list$all,
            file = out.file.name.all)

if (!file.exists(out.file.name.shift))
  write_csv(data.list$shift,
            file = out.file.name.shift)


```



## 2001

```{r}
Year <- 2001
dir.name <- paste0("C_C ", Year)
start.time <- "630"
xls.files <- list.files(path = paste0(data.dir, dir.name), pattern = ".xls")
xls.file.name.inshore <- paste0(data.dir, dir.name, "/", xls.files[1])
xls.file.name.offshore <- paste0(data.dir, dir.name, "/", xls.files[2])

sheet.name.inshore <- "LOGS"
sheet.name.offshore <- "LOGS"

col.names.inshore <- c("DATE",	"EVENT",	"TIME",	"OBS.",
                       "VIS I/O",	"SEA ST",	"C/C"	)

col.types.inshore <- c("date", "numeric", "text", "numeric", 
                       "numeric", "text", "numeric", "numeric", 
                       "text", "text", "text", "text",
                       "text", "text")

# data.out <- read_excel(xls.file.name.inshore,
#                          sheet = sheet.name.inshore,
#                          col_types = col.types.inshore)
#                        
# data.inshore <- get.data(Year = Year,
#                            dir.name = dir.name,
#                            xls.file.name = xls.file.name.inshore,
#                            sheet.name = sheet.name.inshore,
#                            col.types = col.types.inshore,
#                            col.names = col.names.inshore,
#                            area.name = "inshore",
#                            start.time = start.time)

col.names.offshore <- c("DATE",	"EVENT",	"TIME",	"OBS",
                        "VIS",	"SEA STATE",	"C/C")

col.types.offshore <- c("date", "numeric", "text", "numeric", 
                        "numeric", "text", "numeric", "numeric", 
                        "text", "text",  "text", "text")


data.list <- get.all.data(sheet.name.inshore, sheet.name.offshore,
                          col.types.inshore, col.types.offshore,
                          col.names.inshore, col.names.offshore,
                          Year, dir.name, 
                          xls.file.name.inshore, xls.file.name.offshore,
                          start.time)

out.file.name.all <- paste0(out.dir, "Processed_all_data_", 
                            Year, ".csv")
out.file.name.shift <- paste0(out.dir, "Processed_by_shift_data_", 
                              Year, ".csv")

if (!file.exists(out.file.name.all))
  write_csv(data.list$all,
            file = out.file.name.all)

if (!file.exists(out.file.name.shift))
  write_csv(data.list$shift,
            file = out.file.name.shift)


```



## 2002

```{r}
Year <- 2002
dir.name <- paste0("C_C ", Year)
start.time <- "630"
xls.files <- list.files(path = paste0(data.dir, dir.name), pattern = ".xls")
xls.file.name.inshore <- paste0(data.dir, dir.name, "/", xls.files[1])
xls.file.name.offshore <- paste0(data.dir, dir.name, "/", xls.files[2])

sheet.name.inshore <- "LOGS"
sheet.name.offshore <- "LOG"

col.names.inshore <- c("DATE",	"EVENT",	"TIME", 	"OBS",
                       "VIS (I/O)",	"SS",	"C/C")

col.types.inshore <- c("date", "numeric", "text", "numeric", 
                       "numeric", "text", "numeric", "numeric", 
                       "text", "text", "text", "text",
                       "text", "text")

# data.inshore <- get.data(Year = Year,
#                            dir.name = dir.name,
#                            xls.file.name = xls.file.name.inshore,
#                            sheet.name = sheet.name.inshore,
#                            col.types = col.types.inshore,
#                            col.names = col.names.inshore,
#                            area.name = "inshore",
#                            start.time = start.time)

col.names.offshore <- c("DATE",	"EVENT",	"TIME",	"OBS",
                        "VIS",	"SS",	"C/C")

col.types.offshore <- c("date", "numeric", "text", "numeric", 
                        "numeric", "text", "numeric", "numeric", 
                        "text", "text",  "text", "text")


data.list <- get.all.data(sheet.name.inshore, sheet.name.offshore,
                          col.types.inshore, col.types.offshore,
                          col.names.inshore, col.names.offshore,
                          Year, dir.name, 
                          xls.file.name.inshore, xls.file.name.offshore,
                          start.time)

out.file.name.all <- paste0(out.dir, "Processed_all_data_", 
                            Year, ".csv")
out.file.name.shift <- paste0(out.dir, "Processed_by_shift_data_", 
                              Year, ".csv")

if (!file.exists(out.file.name.all))
  write_csv(data.list$all,
            file = out.file.name.all)

if (!file.exists(out.file.name.shift))
  write_csv(data.list$shift,
            file = out.file.name.shift)


```



## 2003

```{r}
Year <- 2003
dir.name <- paste0("C_C ", Year)
start.time <- "630"
xls.files <- list.files(path = paste0(data.dir, dir.name), pattern = ".xls")
xls.file.name.inshore <- paste0(data.dir, dir.name, "/", xls.files[1])
xls.file.name.offshore <- paste0(data.dir, dir.name, "/", xls.files[2])

sheet.name.inshore <- "Logs"
sheet.name.offshore <- "logs"

col.names.inshore <- c("DATE",	"EVENT",	"TIME", 	"OBS",
                       "VIS (I/O)",	"SS",	"C/C")

col.types.inshore <- c("date", "numeric", "text", "numeric", 
                       "numeric", "text", "numeric", "numeric", 
                       "text", "text", "text", "text",
                       "text", "text")

# data.inshore <- get.data(Year = Year,
#                            dir.name = dir.name,
#                            xls.file.name = xls.file.name.inshore,
#                            sheet.name = sheet.name.inshore,
#                            col.types = col.types.inshore,
#                            col.names = col.names.inshore,
#                            area.name = "inshore",
#                            start.time = start.time)

col.names.offshore <- c("DATE",	"EVENT",	"TIME",	"OBS",
                        "VIS",	"SS",	"C/C")

col.types.offshore <- c("date", "numeric", "text", "numeric", 
                        "numeric", "text", "numeric", "numeric", 
                        "text", "text",  "text", "text")


data.list <- get.all.data(sheet.name.inshore, sheet.name.offshore,
                          col.types.inshore, col.types.offshore,
                          col.names.inshore, col.names.offshore,
                          Year, dir.name, 
                          xls.file.name.inshore, xls.file.name.offshore,
                          start.time)

out.file.name.all <- paste0(out.dir, "Processed_all_data_", 
                            Year, ".csv")
out.file.name.shift <- paste0(out.dir, "Processed_by_shift_data_", 
                              Year, ".csv")

if (!file.exists(out.file.name.all))
  write_csv(data.list$all,
            file = out.file.name.all)

if (!file.exists(out.file.name.shift))
  write_csv(data.list$shift,
            file = out.file.name.shift)


```



## 2004

```{r}
Year <- 2004
dir.name <- paste0("C_C ", Year)
start.time <- "630"
xls.files <- list.files(path = paste0(data.dir, dir.name), pattern = ".xls")
xls.file.name.inshore <- paste0(data.dir, dir.name, "/", xls.files[2])
xls.file.name.offshore <- paste0(data.dir, dir.name, "/", xls.files[3])

sheet.name.inshore <- "DATA"
sheet.name.offshore <- "DATA"

col.names.inshore <- c("DATE",	"EVENT",	"TIME", 	"OBS",
                       "VIS (I/O)",	"SS",	"C/C")

col.types.inshore <- c("date", "numeric", "text", "numeric", 
                       "numeric", "text", "numeric", "numeric", 
                       "text", "text", "text", "text",
                       "text", "text")

# data.inshore <- get.data(Year = Year,
#                            dir.name = dir.name,
#                            xls.file.name = xls.file.name.inshore,
#                            sheet.name = sheet.name.inshore,
#                            col.types = col.types.inshore,
#                            col.names = col.names.inshore,
#                            area.name = "inshore",
#                            start.time = start.time)

col.names.offshore <- c("DATE",	"EVENT",	"TIME",	"OBS",	
                        "VIS",	"SS",	"C/C")

col.types.offshore <- c("date", "numeric", "text", "numeric", 
                        "numeric", "text", "numeric", "numeric", 
                        "text", "text",  "text", "text")

data.list <- get.all.data(sheet.name.inshore, sheet.name.offshore,
                          col.types.inshore, col.types.offshore,
                          col.names.inshore, col.names.offshore,
                          Year, dir.name, 
                          xls.file.name.inshore, xls.file.name.offshore,
                          start.time)

out.file.name.all <- paste0(out.dir, "Processed_all_data_", 
                            Year, ".csv")
out.file.name.shift <- paste0(out.dir, "Processed_by_shift_data_", 
                              Year, ".csv")

if (!file.exists(out.file.name.all))
  write_csv(data.list$all,
            file = out.file.name.all)

if (!file.exists(out.file.name.shift))
  write_csv(data.list$shift,
            file = out.file.name.shift)


```



## 2005

```{r}
Year <- 2005
dir.name <- paste0("C_C ", Year)
start.time <- "630"
xls.files <- list.files(path = paste0(data.dir, dir.name), pattern = ".xls")
xls.file.name.inshore <- paste0(data.dir, dir.name, "/", xls.files[1])
xls.file.name.offshore <- paste0(data.dir, dir.name, "/", xls.files[2])

sheet.name.inshore <- "LOGS"
sheet.name.offshore <- "LOGS"

col.names.inshore <- c("DATE",	"EVENT",	"TIME", 	"OBS",
                       "VIS (I/O)",	"SS",	"C/C")

col.types.inshore <- c("date", "numeric", "text", "numeric", 
                       "numeric", "text", "numeric", "numeric", 
                       "text", "text", "text", "text", 
                       "text", "text")

# data.out <- read_excel(xls.file.name.inshore,
#                          sheet = sheet.name.inshore,
#                          col_types = col.types.inshore)

# data.inshore <- get.data(Year = Year,
#                          dir.name = dir.name,
#                          xls.file.name = xls.file.name.inshore,
#                          sheet.name = sheet.name.inshore,
#                          col.types = col.types.inshore,
#                          col.names = col.names.inshore,
#                          area.name = "inshore",
#                          start.time = start.time)

col.names.offshore <- c("DATE",	"EVENT",	"TIME",	"OBS",	
                        "VIS",	"SS",	"C/C")

col.types.offshore <- c("date", "numeric", "text", "numeric", 
                        "numeric", "text", "numeric", "numeric", 
                        "text", "text",  "text", "text")

data.list <- get.all.data(sheet.name.inshore, sheet.name.offshore,
                          col.types.inshore, col.types.offshore,
                          col.names.inshore, col.names.offshore,
                          Year, dir.name, 
                          xls.file.name.inshore, xls.file.name.offshore,
                          start.time)

out.file.name.all <- paste0(out.dir, "Processed_all_data_", 
                            Year, ".csv")
out.file.name.shift <- paste0(out.dir, "Processed_by_shift_data_", 
                              Year, ".csv")

if (!file.exists(out.file.name.all))
  write_csv(data.list$all,
            file = out.file.name.all)

if (!file.exists(out.file.name.shift))
  write_csv(data.list$shift,
            file = out.file.name.shift)

```




## 2006

```{r}
Year <- 2006
dir.name <- paste0("C_C ", Year)
start.time <- "630"
xls.files <- list.files(path = paste0(data.dir, dir.name), pattern = ".xls")
xls.file.name.inshore <- paste0(data.dir, dir.name, "/", xls.files[1])
xls.file.name.offshore <- paste0(data.dir, dir.name, "/", xls.files[2])

sheet.name.inshore <- "LOGS"
sheet.name.offshore <- "LOGS"

col.names.inshore <- c("DATE",	"EVENT", 	"TIME",	"OBS#",
                       "VIS IN",	"SEA ST",	"C/C")

col.types.inshore <- c("date", "numeric", "text", "numeric", 
                       "numeric", "text", "numeric", "numeric", 
                       "text", "text", "text", "text", 
                       "text", "text", "text")

# data.out <- read_excel(xls.file.name.inshore,
#                          sheet = sheet.name.inshore,
#                          col_types = col.types.inshore)

# data.inshore <- get.data(Year = Year,
#                          dir.name = dir.name,
#                          xls.file.name = xls.file.name.inshore,
#                          sheet.name = sheet.name.inshore,
#                          col.types = col.types.inshore,
#                          col.names = col.names.inshore,
#                          area.name = "inshore",
#                          start.time = start.time)

col.names.offshore <- c("DATE",	"EVENT",	"TIME",	"OBS",	
                        "VIS",	"SEA ST",	"C/C")

col.types.offshore <- c("date", "numeric", "text", "numeric", 
                        "numeric", "text", "numeric", "numeric", 
                        "text", "text",  "text", "text")

data.list <- get.all.data(sheet.name.inshore, sheet.name.offshore,
                          col.types.inshore, col.types.offshore,
                          col.names.inshore, col.names.offshore,
                          Year, dir.name, 
                          xls.file.name.inshore, xls.file.name.offshore,
                          start.time)

out.file.name.all <- paste0(out.dir, "Processed_all_data_", 
                            Year, ".csv")
out.file.name.shift <- paste0(out.dir, "Processed_by_shift_data_", 
                              Year, ".csv")

if (!file.exists(out.file.name.all))
  write_csv(data.list$all,
            file = out.file.name.all)

if (!file.exists(out.file.name.shift))
  write_csv(data.list$shift,
            file = out.file.name.shift)

```



## 2007

```{r}
Year <- 2007
dir.name <- paste0("C_C ", Year)
start.time <- "630"
xls.files <- list.files(path = paste0(data.dir, dir.name), pattern = ".xls")
xls.file.name.inshore <- paste0(data.dir, dir.name, "/", xls.files[1])
xls.file.name.offshore <- paste0(data.dir, dir.name, "/", xls.files[2])

sheet.name.inshore <- "log"
sheet.name.offshore <- "log"

col.names.inshore <- c("DATE",	"EVENT", 	"TIME",	"OBS#",
                       "VIS IN",	"SEA ST",	"C/C")

col.types.inshore <- c("date", "numeric", "text", "numeric", 
                       "numeric", "text", "numeric", "numeric", 
                       "text", "text", "text", "text", 
                       "text", "text", "text", "text")

# data.out <- read_excel(xls.file.name.inshore,
#                          sheet = sheet.name.inshore,
#                          col_types = col.types.inshore)

# data.inshore <- get.data(Year = Year,
#                          dir.name = dir.name,
#                          xls.file.name = xls.file.name.inshore,
#                          sheet.name = sheet.name.inshore,
#                          col.types = col.types.inshore,
#                          col.names = col.names.inshore,
#                          area.name = "inshore",
#                          start.time = start.time)


col.names.offshore <- c("DATE",	"EVENT",	"TIME",	"OBS",	
                        "VIS",	"SEA ST",	"C/C")

col.types.offshore <- c("date", "numeric", "text", "numeric", 
                        "numeric", "text", "numeric", "numeric", 
                        "text", "text",  "text", "text")

data.list <- get.all.data(sheet.name.inshore, sheet.name.offshore,
                          col.types.inshore, col.types.offshore,
                          col.names.inshore, col.names.offshore,
                          Year, dir.name, 
                          xls.file.name.inshore, xls.file.name.offshore,
                          start.time)

out.file.name.all <- paste0(out.dir, "Processed_all_data_", 
                            Year, ".csv")
out.file.name.shift <- paste0(out.dir, "Processed_by_shift_data_", 
                              Year, ".csv")

if (!file.exists(out.file.name.all))
  write_csv(data.list$all,
            file = out.file.name.all)

if (!file.exists(out.file.name.shift))
  write_csv(data.list$shift,
            file = out.file.name.shift)

```




## 2008

```{r}
Year <- 2008
dir.name <- paste0("C_C ", Year)
start.time <- "630"
xls.files <- list.files(path = paste0(data.dir, dir.name), pattern = ".xls")
xls.file.name.inshore <- paste0(data.dir, dir.name, "/", xls.files[1])
xls.file.name.offshore <- paste0(data.dir, dir.name, "/", xls.files[2])

sheet.name.inshore <- "LOG"
sheet.name.offshore <- "LOGS"

col.names.inshore <- c("DATE",	"EVENT", 	"TIME",	"OBS#",
                       "VIS IN",	"SEA ST",	"C/C")

col.types.inshore <- c("date", "numeric", "text", "numeric", 
                       "numeric", "text", "numeric", "numeric", 
                       "text", "text", "text", "text", 
                       "text", "text", "text")

# data.out <- read_excel(xls.file.name.inshore,
#                          sheet = sheet.name.inshore,
#                          col_types = col.types.inshore)

# data.inshore <- get.data(Year = Year,
#                          dir.name = dir.name,
#                          xls.file.name = xls.file.name.inshore,
#                          sheet.name = sheet.name.inshore,
#                          col.types = col.types.inshore,
#                          col.names = col.names.inshore,
#                          area.name = "inshore",
#                          start.time = start.time)


col.names.offshore <- c("DATE",	"EVENT",	"TIME",	"OBS",	
                        "VIS",	"SEA ST",	"C/C")

col.types.offshore <- c("date", "numeric", "text", "numeric", 
                        "numeric", "text", "numeric", "numeric", 
                        "text", "text",  "text", "text")

data.list <- get.all.data(sheet.name.inshore, sheet.name.offshore,
                          col.types.inshore, col.types.offshore,
                          col.names.inshore, col.names.offshore,
                          Year, dir.name, 
                          xls.file.name.inshore, xls.file.name.offshore,
                          start.time)

out.file.name.all <- paste0(out.dir, "Processed_all_data_", 
                            Year, ".csv")
out.file.name.shift <- paste0(out.dir, "Processed_by_shift_data_", 
                              Year, ".csv")

if (!file.exists(out.file.name.all))
  write_csv(data.list$all,
            file = out.file.name.all)

if (!file.exists(out.file.name.shift))
  write_csv(data.list$shift,
            file = out.file.name.shift)

```


## 2009

```{r}
Year <- 2009
dir.name <- paste0("C_C ", Year)
start.time <- "630"
xls.files <- list.files(path = paste0(data.dir, dir.name), pattern = ".xls")
xls.file.name.inshore <- paste0(data.dir, dir.name, "/", xls.files[1])
xls.file.name.offshore <- paste0(data.dir, dir.name, "/", xls.files[2])

sheet.name.inshore <- "LOGS"
sheet.name.offshore <- "LOGS"

col.names.inshore <- c("DATE",	"EVENT", 	"TIME",	"OBS#",
                       "VIS IN",	"SEA ST",	"C/C")

col.types.inshore <- c("date", "numeric", "text", "numeric", 
                       "numeric", "text", "numeric", "numeric", 
                       "text", "text", "text", "text", 
                       "text", "text", "text")

# data.out <- read_excel(xls.file.name.inshore,
#                          sheet = sheet.name.inshore,
#                          col_types = col.types.inshore)

# data.inshore <- get.data(Year = Year,
#                          dir.name = dir.name,
#                          xls.file.name = xls.file.name.inshore,
#                          sheet.name = sheet.name.inshore,
#                          col.types = col.types.inshore,
#                          col.names = col.names.inshore,
#                          area.name = "inshore",
#                          start.time = start.time)


col.names.offshore <- c("DATE",	"EVENT",	"TIME",	"OBS",	
                        "VIS",	"SEA ST",	"C/C")

col.types.offshore <- c("date", "numeric", "text", "numeric", 
                        "numeric", "text", "numeric", "numeric", 
                        "text", "text",  "text", "text")

data.list <- get.all.data(sheet.name.inshore, sheet.name.offshore,
                          col.types.inshore, col.types.offshore,
                          col.names.inshore, col.names.offshore,
                          Year, dir.name, 
                          xls.file.name.inshore, xls.file.name.offshore,
                          start.time)

out.file.name.all <- paste0(out.dir, "Processed_all_data_", 
                            Year, ".csv")
out.file.name.shift <- paste0(out.dir, "Processed_by_shift_data_", 
                              Year, ".csv")

if (!file.exists(out.file.name.all))
  write_csv(data.list$all,
            file = out.file.name.all)

if (!file.exists(out.file.name.shift))
  write_csv(data.list$shift,
            file = out.file.name.shift)

```


Files seem to be about the same from these years... 



## 2010

```{r}
Year <- 2010
dir.name <- paste0("C_C ", Year)
start.time <- "630"
xls.files <- list.files(path = paste0(data.dir, dir.name), pattern = ".xls")
xls.file.name.inshore <- paste0(data.dir, dir.name, "/", xls.files[2])
xls.file.name.offshore <- paste0(data.dir, dir.name, "/", xls.files[3])

sheet.name.inshore <- "LOGS"
sheet.name.offshore <- "LOGS"

col.names.inshore <- c("DATE",	"EVENT", 	"TIME",	"OBS#",
                       "VIS IN",	"SEA ST",	"C/C")

col.types.inshore <- c("date", "numeric", "text", "numeric", 
                       "numeric", "text", "numeric", "numeric", 
                       "text", "text", "text", "text", 
                       "text", "text", "text")

# data.out <- read_excel(xls.file.name.inshore,
#                          sheet = sheet.name.inshore,
#                          col_types = col.types.inshore)

# data.inshore <- get.data(Year = Year,
#                          dir.name = dir.name,
#                          xls.file.name = xls.file.name.inshore,
#                          sheet.name = sheet.name.inshore,
#                          col.types = col.types.inshore,
#                          col.names = col.names.inshore,
#                          area.name = "inshore",
#                          start.time = start.time)


col.names.offshore <- c("DATE",	"EVENT",	"TIME",	"OBS",	
                        "VIS",	"SEA ST",	"C/C")

col.types.offshore <- c("date", "numeric", "text", "numeric", 
                        "numeric", "text", "numeric", "numeric", 
                        "text", "text",  "text", "text")

data.list <- get.all.data(sheet.name.inshore, sheet.name.offshore,
                          col.types.inshore, col.types.offshore,
                          col.names.inshore, col.names.offshore,
                          Year, dir.name, 
                          xls.file.name.inshore, xls.file.name.offshore,
                          start.time)

out.file.name.all <- paste0(out.dir, "Processed_all_data_", 
                            Year, ".csv")
out.file.name.shift <- paste0(out.dir, "Processed_by_shift_data_", 
                              Year, ".csv")

if (!file.exists(out.file.name.all))
  write_csv(data.list$all,
            file = out.file.name.all)

if (!file.exists(out.file.name.shift))
  write_csv(data.list$shift,
            file = out.file.name.shift)

```



## 2011

```{r}
Year <- 2011
dir.name <- paste0("C_C ", Year)
start.time <- "630"
xls.files <- list.files(path = paste0(data.dir, dir.name), pattern = ".xls")
xls.file.name.inshore <- paste0(data.dir, dir.name, "/", xls.files[2])
xls.file.name.offshore <- paste0(data.dir, dir.name, "/", xls.files[3])

sheet.name.inshore <- "LOGS"
sheet.name.offshore <- "LOGS"

col.names.inshore <- c("DATE",	"EVENT", 	"TIME",	"OBS#",
                       "VIS IN",	"SEA ST",	"C/C")

col.types.inshore <- c("date", "numeric", "text", "numeric", 
                       "numeric", "text", "numeric", "numeric", 
                       "text", "text", "text", "text", 
                       "text", "text", "text")

# data.out <- read_excel(xls.file.name.inshore,
#                          sheet = sheet.name.inshore,
#                          col_types = col.types.inshore)

# data.inshore <- get.data(Year = Year,
#                          dir.name = dir.name,
#                          xls.file.name = xls.file.name.inshore,
#                          sheet.name = sheet.name.inshore,
#                          col.types = col.types.inshore,
#                          col.names = col.names.inshore,
#                          area.name = "inshore",
#                          start.time = start.time)


col.names.offshore <- c("DATE",	"EVENT",	"TIME",	"OBS",	
                        "VIS",	"SEA ST",	"C/C")

col.types.offshore <- c("date", "numeric", "text", "numeric", 
                        "numeric", "text", "numeric", "numeric", 
                        "text", "text",  "text", "text")

data.list <- get.all.data(sheet.name.inshore, sheet.name.offshore,
                          col.types.inshore, col.types.offshore,
                          col.names.inshore, col.names.offshore,
                          Year, dir.name, 
                          xls.file.name.inshore, xls.file.name.offshore,
                          start.time)

out.file.name.all <- paste0(out.dir, "Processed_all_data_", 
                            Year, ".csv")
out.file.name.shift <- paste0(out.dir, "Processed_by_shift_data_", 
                              Year, ".csv")

if (!file.exists(out.file.name.all))
  write_csv(data.list$all,
            file = out.file.name.all)

if (!file.exists(out.file.name.shift))
  write_csv(data.list$shift,
            file = out.file.name.shift)

```



## 2012

```{r}
Year <- 2012
dir.name <- paste0("C_C ", Year)
start.time <- "630"
xls.files <- list.files(path = paste0(data.dir, dir.name), pattern = ".xls")
xls.file.name.inshore <- paste0(data.dir, dir.name, "/", xls.files[2])
xls.file.name.offshore <- paste0(data.dir, dir.name, "/", xls.files[3])

sheet.name.inshore <- "LOGS"
sheet.name.offshore <- "LOGS"

col.names.inshore <- c("DATE",	"EVENT", 	"TIME",	"OBS#",
                       "VIS IN",	"SEA ST",	"C/C")

col.types.inshore <- c("date", "numeric", "text", "numeric", 
                       "numeric", "text", "numeric", "numeric", 
                       "text", "text", "text", "text", 
                       "text", "text", "text")

# data.out <- read_excel(xls.file.name.inshore,
#                          sheet = sheet.name.inshore,
#                          col_types = col.types.inshore)

# data.inshore <- get.data(Year = Year,
#                          dir.name = dir.name,
#                          xls.file.name = xls.file.name.inshore,
#                          sheet.name = sheet.name.inshore,
#                          col.types = col.types.inshore,
#                          col.names = col.names.inshore,
#                          area.name = "inshore",
#                          start.time = start.time)


col.names.offshore <- c("DATE",	"EVENT",	"TIME",	"OBS",	
                        "VIS",	"SEA ST",	"C/C")

col.types.offshore <- c("date", "numeric", "text", "numeric", 
                        "numeric", "text", "numeric", "numeric", 
                        "text", "text",  "text", "text")

data.list <- get.all.data(sheet.name.inshore, sheet.name.offshore,
                          col.types.inshore, col.types.offshore,
                          col.names.inshore, col.names.offshore,
                          Year, dir.name, 
                          xls.file.name.inshore, xls.file.name.offshore,
                          start.time)

out.file.name.all <- paste0(out.dir, "Processed_all_data_", 
                            Year, ".csv")
out.file.name.shift <- paste0(out.dir, "Processed_by_shift_data_", 
                              Year, ".csv")

if (!file.exists(out.file.name.all))
  write_csv(data.list$all,
            file = out.file.name.all)

if (!file.exists(out.file.name.shift))
  write_csv(data.list$shift,
            file = out.file.name.shift)

```



## 2013

```{r}
Year <- 2013
dir.name <- paste0("C_C ", Year)
start.time <- "630"
xls.files <- list.files(path = paste0(data.dir, dir.name), pattern = ".xls")
xls.file.name.inshore <- paste0(data.dir, dir.name, "/", xls.files[1])
xls.file.name.offshore <- paste0(data.dir, dir.name, "/", xls.files[2])

sheet.name.inshore <- "LOGS"
sheet.name.offshore <- "LOGS"

col.names.inshore <- c("DATE",	"EVENT", 	"TIME",	"OBS#",
                       "VIS IN",	"SEA ST",	"C/C")

col.types.inshore <- c("date", "numeric", "text", "numeric", 
                       "numeric", "text", "numeric", "numeric", 
                       "text", "text", "text", "text", 
                       "text", "text", "text")

# data.out <- read_excel(xls.file.name.inshore,
#                          sheet = sheet.name.inshore,
#                          col_types = col.types.inshore)

# data.inshore <- get.data(Year = Year,
#                          dir.name = dir.name,
#                          xls.file.name = xls.file.name.inshore,
#                          sheet.name = sheet.name.inshore,
#                          col.types = col.types.inshore,
#                          col.names = col.names.inshore,
#                          area.name = "inshore",
#                          start.time = start.time)


col.names.offshore <- c("DATE",	"EVENT",	"TIME",	"OBS",	
                        "VIS",	"SEA ST",	"C/C")

col.types.offshore <- c("date", "numeric", "text", "numeric", 
                        "numeric", "text", "numeric", "numeric", 
                        "text", "text",  "text", "text")

data.list <- get.all.data(sheet.name.inshore, sheet.name.offshore,
                          col.types.inshore, col.types.offshore,
                          col.names.inshore, col.names.offshore,
                          Year, dir.name, 
                          xls.file.name.inshore, xls.file.name.offshore,
                          start.time)

out.file.name.all <- paste0(out.dir, "Processed_all_data_", 
                            Year, ".csv")
out.file.name.shift <- paste0(out.dir, "Processed_by_shift_data_", 
                              Year, ".csv")

if (!file.exists(out.file.name.all))
  write_csv(data.list$all,
            file = out.file.name.all)

if (!file.exists(out.file.name.shift))
  write_csv(data.list$shift,
            file = out.file.name.shift)

```



## 2014

```{r}
Year <- 2014
dir.name <- paste0("C_C ", Year)
start.time <- "630"
xls.files <- list.files(path = paste0(data.dir, dir.name), pattern = ".xls")
xls.file.name.inshore <- paste0(data.dir, dir.name, "/", xls.files[1])
xls.file.name.offshore <- paste0(data.dir, dir.name, "/", xls.files[2])

sheet.name.inshore <- "LOGS"
sheet.name.offshore <- "LOGS"

col.names.inshore <- c("DATE",	"EVENT", 	"TIME",	"OBS#",
                       "VIS IN",	"SEA ST",	"C/C")

col.types.inshore <- c("date", "numeric", "text", "numeric", 
                       "numeric", "text", "numeric", "numeric", 
                       "text", "text", "text", "text", 
                       "text", "text", "text")

# data.out <- read_excel(xls.file.name.inshore,
#                          sheet = sheet.name.inshore,
#                          col_types = col.types.inshore)

# data.inshore <- get.data(Year = Year,
#                          dir.name = dir.name,
#                          xls.file.name = xls.file.name.inshore,
#                          sheet.name = sheet.name.inshore,
#                          col.types = col.types.inshore,
#                          col.names = col.names.inshore,
#                          area.name = "inshore",
#                          start.time = start.time)


col.names.offshore <- c("DATE",	"EVENT",	"TIME",	"OBS",	
                        "VIS",	"SEA ST",	"C/C")

col.types.offshore <- c("date", "numeric", "text", "numeric", 
                        "numeric", "text", "numeric", "numeric", 
                        "text", "text",  "text", "text")

data.list <- get.all.data(sheet.name.inshore, sheet.name.offshore,
                          col.types.inshore, col.types.offshore,
                          col.names.inshore, col.names.offshore,
                          Year, dir.name, 
                          xls.file.name.inshore, xls.file.name.offshore,
                          start.time)

out.file.name.all <- paste0(out.dir, "Processed_all_data_", 
                            Year, ".csv")
out.file.name.shift <- paste0(out.dir, "Processed_by_shift_data_", 
                              Year, ".csv")

if (!file.exists(out.file.name.all))
  write_csv(data.list$all,
            file = out.file.name.all)

if (!file.exists(out.file.name.shift))
  write_csv(data.list$shift,
            file = out.file.name.shift)

```


## 2015

```{r}
Year <- 2015
dir.name <- paste0("C_C ", Year)
start.time <- "630"
xls.files <- list.files(path = paste0(data.dir, dir.name), pattern = ".xls")
xls.file.name.inshore <- paste0(data.dir, dir.name, "/", xls.files[1])
xls.file.name.offshore <- paste0(data.dir, dir.name, "/", xls.files[3])

sheet.name.inshore <- "LOGS"
sheet.name.offshore <- "LOGS"

col.names.inshore <- c("DATE",	"EVENT", 	"TIME",	"OBS#",
                       "VIS IN",	"SEA ST",	"C/C")

col.types.inshore <- c("date", "numeric", "text", "numeric", 
                       "numeric", "text", "numeric", "numeric", 
                       "text", "text", "text", "text", 
                       "text", "text", "text")

# data.out <- read_excel(xls.file.name.inshore,
#                          sheet = sheet.name.inshore,
#                          col_types = col.types.inshore)

# data.inshore <- get.data(Year = Year,
#                          dir.name = dir.name,
#                          xls.file.name = xls.file.name.inshore,
#                          sheet.name = sheet.name.inshore,
#                          col.types = col.types.inshore,
#                          col.names = col.names.inshore,
#                          area.name = "inshore",
#                          start.time = start.time)


col.names.offshore <- c("DATE",	"EVENT",	"TIME",	"OBS",	
                        "VIS",	"SEA ST",	"C/C")

col.types.offshore <- c("date", "numeric", "text", "numeric", 
                        "numeric", "text", "numeric", "numeric", 
                        "text", "text",  "text", "text")

data.list <- get.all.data(sheet.name.inshore, sheet.name.offshore,
                          col.types.inshore, col.types.offshore,
                          col.names.inshore, col.names.offshore,
                          Year, dir.name, 
                          xls.file.name.inshore, xls.file.name.offshore,
                          start.time)

out.file.name.all <- paste0(out.dir, "Processed_all_data_", 
                            Year, ".csv")
out.file.name.shift <- paste0(out.dir, "Processed_by_shift_data_", 
                              Year, ".csv")

if (!file.exists(out.file.name.all))
  write_csv(data.list$all,
            file = out.file.name.all)

if (!file.exists(out.file.name.shift))
  write_csv(data.list$shift,
            file = out.file.name.shift)

```



## 2016

```{r}
Year <- 2016
dir.name <- paste0("C_C ", Year)
start.time <- "630"
xls.files <- list.files(path = paste0(data.dir, dir.name), pattern = ".xls")
xls.file.name.inshore <- paste0(data.dir, dir.name, "/", xls.files[2])
xls.file.name.offshore <- paste0(data.dir, dir.name, "/", xls.files[3])

sheet.name.inshore <- "LOGS"
sheet.name.offshore <- NULL

col.names.inshore <- c("DATE",	"EVENT", 	"TIME",	"OBS#",
                       "VIS IN",	"SEA ST",	"C/C")

col.types.inshore <- c("date", "numeric", "text", "numeric", 
                       "numeric", "text", "numeric", "numeric", 
                       "text", "text", "text", "text", 
                       "text", "text", "text")

# data.out <- read_excel(xls.file.name.inshore,
#                          sheet = sheet.name.inshore,
#                          col_types = col.types.inshore)

# data.inshore <- get.data(Year = Year,
#                          dir.name = dir.name,
#                          xls.file.name = xls.file.name.inshore,
#                          sheet.name = sheet.name.inshore,
#                          col.types = col.types.inshore,
#                          col.names = col.names.inshore,
#                          area.name = "inshore",
#                          start.time = start.time)


col.names.offshore <- c("DATE",	"EVENT",	"TIME",	"OBS",	
                        "VIS",	"SEA ST",	"C/C")

col.types.offshore <- c("date", "numeric", "text", "numeric", 
                        "numeric", "text", "numeric", "numeric", 
                        "text", "text",  "text", "text")

data.list <- get.all.data(sheet.name.inshore, sheet.name.offshore,
                          col.types.inshore, col.types.offshore,
                          col.names.inshore, col.names.offshore,
                          Year, dir.name, 
                          xls.file.name.inshore, xls.file.name.offshore,
                          start.time)

out.file.name.all <- paste0(out.dir, "Processed_all_data_", 
                            Year, ".csv")
out.file.name.shift <- paste0(out.dir, "Processed_by_shift_data_", 
                              Year, ".csv")

if (!file.exists(out.file.name.all))
  write_csv(data.list$all,
            file = out.file.name.all)

if (!file.exists(out.file.name.shift))
  write_csv(data.list$shift,
            file = out.file.name.shift)

```


## 2017

No offshore log exists for 2017
```{r}
Year <- 2017
dir.name <- paste0("C_C ", Year)
start.time <- "630"
xls.files <- list.files(path = paste0(data.dir, dir.name), pattern = ".xls")
xls.file.name.inshore <- paste0(data.dir, dir.name, "/", xls.files[1])

sheet.name.inshore <- "LOGS"

col.names.inshore <- c("DATE",	"EVENT", 	"TIME",	"OBS#",
                       "VIS IN",	"SEA ST",	"C/C")

col.types.inshore <- c("date", "numeric", "text", "text", 
                       "numeric", "text", "numeric", "numeric", 
                       "text", "text", "text", "text", 
                       "text", "text", "text", "text",
                       "text", "text")

# data.out <- read_excel(xls.file.name.inshore,
#                          sheet = sheet.name.inshore,
#                          col_types = col.types.inshore)

data.inshore <- get.data(Year = Year,
                         dir.name = dir.name,
                         xls.file.name = xls.file.name.inshore,
                         sheet.name = sheet.name.inshore,
                         col.types = col.types.inshore,
                         col.names = col.names.inshore,
                         area.name = "inshore",
                         start.time = start.time)

data.all <- data.inshore %>% 
    filter(!is.na(Date)) %>%
    filter(!is.na(Event)) %>%
    filter(!is.na(Shift)) %>%
    arrange(Date, Minutes_since_T0)
  
data.all %>% 
  group_by(Date, Shift) %>%
  summarise(Date = min(Date),
            Sea_State = max(SeaState, na.rm = T),
            Vis = max(Vis, na.rm = T),
            Mother_Calf = sum(Mother_Calf, na.rm = T),
            Duration = max(Minutes_since_0000, na.rm = T) - 
              min(Minutes_since_0000, na.rm = T),
            Time_T0 = min(Minutes_since_T0, na.rm = T),
            Time_0000 = min(Minutes_since_0000, na.rm = T)) -> data.shift

out.file.name.all <- paste0(out.dir, "Processed_all_data_", 
                            Year, ".csv")
out.file.name.shift <- paste0(out.dir, "Processed_by_shift_data_", 
                              Year, ".csv")

if (!file.exists(out.file.name.all))
  write_csv(data.all,
            file = out.file.name.all)

if (!file.exists(out.file.name.shift))
  write_csv(data.shift,
            file = out.file.name.shift)

```



## 2018

No offshore log exists for 2018
```{r}
Year <- 2018
dir.name <- paste0("C_C ", Year)
start.time <- "630"
xls.files <- list.files(path = paste0(data.dir, dir.name), pattern = ".xls")
xls.file.name.inshore <- paste0(data.dir, dir.name, "/", xls.files[1])

sheet.name.inshore <- "LOGS"

col.names.inshore <- c("DATE",	"EVENT", 	"TIME",	"OBS#",
                       "VIS IN",	"SEA ST",	"C/C")

col.types.inshore <- c("numeric", "date", "numeric", "text", "text", 
                       "numeric", "text", "numeric", "numeric", 
                       "text", "text", "text", "text", 
                       "text", "text", "text", "text",
                       "text", "text", "text", "text")

# data.out <- read_excel(xls.file.name.inshore,
#                          sheet = sheet.name.inshore,
#                          col_types = col.types.inshore)

data.inshore <- get.data(Year = Year,
                         dir.name = dir.name,
                         xls.file.name = xls.file.name.inshore,
                         sheet.name = sheet.name.inshore,
                         col.types = col.types.inshore,
                         col.names = col.names.inshore,
                         area.name = "inshore",
                         start.time = start.time)

data.all <- data.inshore %>% 
    filter(!is.na(Date)) %>%
    filter(!is.na(Event)) %>%
    filter(!is.na(Shift)) %>%
    arrange(Date, Minutes_since_T0)
  
data.all %>% 
  group_by(Date, Shift) %>%
  summarise(Date = min(Date),
            Sea_State = max(SeaState, na.rm = T),
            Vis = max(Vis, na.rm = T),
            Mother_Calf = sum(Mother_Calf, na.rm = T),
            Duration = max(Minutes_since_0000, na.rm = T) - 
              min(Minutes_since_0000, na.rm = T),
            Time_T0 = min(Minutes_since_T0, na.rm = T),
            Time_0000 = min(Minutes_since_0000, na.rm = T)) -> data.shift

out.file.name.all <- paste0(out.dir, "Processed_all_data_", 
                            Year, ".csv")
out.file.name.shift <- paste0(out.dir, "Processed_by_shift_data_", 
                              Year, ".csv")

if (!file.exists(out.file.name.all))
  write_csv(data.all,
            file = out.file.name.all)

if (!file.exists(out.file.name.shift))
  write_csv(data.shift,
            file = out.file.name.shift)

```





## 2019

No offshore log exists for 2019
```{r}
Year <- 2019
dir.name <- paste0("C_C ", Year)
start.time <- "630"
xls.files <- list.files(path = paste0(data.dir, dir.name), pattern = ".xls")
xls.file.name.inshore <- paste0(data.dir, dir.name, "/", xls.files[1])

sheet.name.inshore <- "INSHORE LOGS"

col.names.inshore <- c("DATE",	"EVENT", 	"TIME",	"OBS #",
                       "VIS IN",	"SEA ST",	"C/C")

col.types.inshore <- c("date", "numeric", "numeric", "text", "text", 
                       "numeric", "text", "numeric", "numeric", 
                       "text", "text", "text", "text", 
                       "text", "text", "text", "text",
                       "text", "text", "text")

# data.out <- read_excel(xls.file.name.inshore,
#                          sheet = sheet.name.inshore,
#                          col_types = col.types.inshore)

data.inshore <- get.data(Year = Year,
                         dir.name = dir.name,
                         xls.file.name = xls.file.name.inshore,
                         sheet.name = sheet.name.inshore,
                         col.types = col.types.inshore,
                         col.names = col.names.inshore,
                         area.name = "inshore",
                         start.time = start.time)

data.all <- data.inshore %>% 
    filter(!is.na(Date)) %>%
    filter(!is.na(Event)) %>%
    filter(!is.na(Shift)) %>%
    arrange(Date, Minutes_since_T0)
  
data.all %>% 
  group_by(Date, Shift) %>%
  summarise(Date = min(Date),
            Sea_State = max(SeaState, na.rm = T),
            Vis = max(Vis, na.rm = T),
            Mother_Calf = sum(Mother_Calf, na.rm = T),
            Duration = max(Minutes_since_0000, na.rm = T) - 
              min(Minutes_since_0000, na.rm = T),
            Time_T0 = min(Minutes_since_T0, na.rm = T),
            Time_0000 = min(Minutes_since_0000, na.rm = T)) -> data.shift

out.file.name.all <- paste0(out.dir, "Processed_all_data_", 
                            Year, ".csv")
out.file.name.shift <- paste0(out.dir, "Processed_by_shift_data_", 
                              Year, ".csv")

if (!file.exists(out.file.name.all))
  write_csv(data.all,
            file = out.file.name.all)

if (!file.exists(out.file.name.shift))
  write_csv(data.shift,
            file = out.file.name.shift)

```


No data for 2020 - COVID.

## 2021

```{r}
Year <- 2021
dir.name <- paste0("C_C ", Year)
start.time <- "630"
xls.files <- list.files(path = paste0(data.dir, dir.name), pattern = ".xls")
xls.file.name.inshore <- paste0(data.dir, dir.name, "/", xls.files[1])

sheet.name.inshore <- "INSHORE LOGS"

col.names.inshore <- c("DATE",	"EVENT", 	"TIME",	"OBS #",
                       "VIS IN",	"SEA ST",	"C/C")

col.types.inshore <- c("date", "numeric", "numeric", "text", "text", 
                       "numeric", "text", "numeric", "numeric", 
                       "text", "text", "text", "text", 
                       "text", "text", "text", "text",
                       "text", "text", "text", "text", "text")

# data.out <- read_excel(xls.file.name.inshore,
#                          sheet = sheet.name.inshore,
#                          col_types = col.types.inshore)

data.inshore <- get.data(Year = Year,
                         dir.name = dir.name,
                         xls.file.name = xls.file.name.inshore,
                         sheet.name = sheet.name.inshore,
                         col.types = col.types.inshore,
                         col.names = col.names.inshore,
                         area.name = "inshore",
                         start.time = start.time)

data.all <- data.inshore %>% 
    filter(!is.na(Date)) %>%
    filter(!is.na(Event)) %>%
    filter(!is.na(Shift)) %>%
    arrange(Date, Minutes_since_T0)
  
data.all %>% 
  group_by(Date, Shift) %>%
  summarise(Date = min(Date),
            Sea_State = max(SeaState, na.rm = T),
            Vis = max(Vis, na.rm = T),
            Mother_Calf = sum(Mother_Calf, na.rm = T),
            Duration = max(Minutes_since_0000, na.rm = T) - 
              min(Minutes_since_0000, na.rm = T),
            Time_T0 = min(Minutes_since_T0, na.rm = T),
            Time_0000 = min(Minutes_since_0000, na.rm = T)) -> data.shift

out.file.name.all <- paste0(out.dir, "Processed_all_data_", 
                            Year, ".csv")
out.file.name.shift <- paste0(out.dir, "Processed_by_shift_data_", 
                              Year, ".csv")

if (!file.exists(out.file.name.all))
  write_csv(data.all,
            file = out.file.name.all)

if (!file.exists(out.file.name.shift))
  write_csv(data.shift,
            file = out.file.name.shift)

```


## 2022

For 2022 and beyond, I added some code here to skip using Collating and Formatting v2.R. It's much easier to get all necessary steps done here, directly out of Excel input files than going through many scripts. 

```{r}
Year <- 2022
dir.name <- paste0("C_C ", Year)
start.time <- "700"
xls.files <- list.files(path = paste0(data.dir, dir.name), pattern = ".xls")
xls.file.name.inshore <- paste0(data.dir, dir.name, "/", xls.files[1])

sheet.name <- "MomCalf Logs 2022"
# c("Date", "Event", "Time", "Obs. Code", 
#  "Sea State", "Vis. IN", "Cow  / Calf")

# These are not the names of all columns. These are the names of columns in the
# spreadsheet that are needed. These names change among years, so they need to
# be specified for each year.
col.names <- c("DATE", 	"EVENT", 	"TIME",	"OBS #",
               "SEA ST", "VIS IN", "M/C")

col.types <- c("date", "numeric", "numeric", "text", "text", 
               "numeric", "numeric", "numeric", "numeric", "text", 
               "text", "text", "text", "numeric", "text", 
               "text", "text", "text")

# data.out <- read_excel(xls.file.name.inshore,
#                          sheet = sheet.name.inshore,
#                          col_types = col.types.inshore)

data.inshore <- get.data(Year = Year,
                         dir.name = dir.name,
                         xls.file.name = xls.file.name.inshore,
                         sheet.name = sheet.name,
                         col.types = col.types,
                         col.names = all_of(col.names),
                         area.name = "inshore",
                         start.time = start.time)

data.all <- data.inshore %>% 
    filter(!is.na(Date)) %>%
    filter(!is.na(Event)) %>%
    filter(!is.na(Shift)) %>%
    arrange(Date, Minutes_since_T0)
  
data.all %>% 
  group_by(Date, Shift) %>%
  summarise(Date = min(Date),
            Sea_State = max(SeaState, na.rm = T),
            Vis = max(Vis, na.rm = T),
            Mother_Calf = sum(Mother_Calf, na.rm = T),
            Duration = max(Minutes_since_0000, na.rm = T) - 
              min(Minutes_since_0000, na.rm = T),
            Time_T0 = min(Minutes_since_T0, na.rm = T),
            Time_0000 = min(Minutes_since_0000, na.rm = T)) -> data.shift

all.weeks <- seq.Date(as.Date(min(data.shift$Date)),
                      as.Date(max(data.shift$Date)),
                      by = "week")

data.shift %>% select(Shift, Date, Duration, Mother_Calf) %>%
  mutate(Date = format(Date, "%Y-%m-%d"),
         Effort = Duration/60,
         Sightings = Mother_Calf) %>%
  select(Date, Shift, Effort, Sightings) %>%
  mutate(Date = as.Date(Date)) %>%
  data.frame() -> raw.data

# has to have four shifts per day... and additional four shifts for evening.
all.dates <- seq.Date(as.Date(min(data.shift$Date)),
                      as.Date(max(data.shift$Date)),
                      by = "day")

all.shifts <- data.frame(Date = rep(all.dates,
                                    each = 8),
                         Shift = rep(1:8, 
                                     times = length(all.dates),
                                     by = "day"))

all.shifts %>% 
  left_join(raw.data, by = c("Date", "Shift")) %>%
  mutate(Week = ceiling(difftime(Date, min(all.dates), 
                                 units = "weeks")) %>%
           as.numeric()) %>%
  select(Week, Date, Effort, Sightings) -> formatted.all.data

# need to change week = 0 to week = 1...
formatted.all.data[formatted.all.data$Week == 0, "Week"] <- 1

# Change NAs to 0s
formatted.all.data[is.na(formatted.all.data)] <- 0

out.file.name.all <- paste0(out.dir, "Processed_all_data_", 
                            Year, ".csv")
out.file.name.shift <- paste0(out.dir, "Processed_by_shift_data_", 
                              Year, ".csv")

out.file.name.formatted <- paste0("data/Formatted Annual Data/", Year, " Formatted.csv")

if (!file.exists(out.file.name.all))
  write_csv(data.all,
            file = out.file.name.all,
            quote = "none")

if (!file.exists(out.file.name.shift))
  write_csv(data.shift,
            file = out.file.name.shift, 
            quote = "none")

# Need to remove NA to be used in Collating and Formatting v2.R
if (!file.exists(out.file.name.raw))
  write_csv(formatted.all.data,
            file = out.file.name.formatted, 
            quote = "none",
            na = "")

```

