---
title: "R Notebook"
output: html_notebook
---

This notebook is used to extract data from original data files in the Excel format. Because the file format changes over time, each year is done separately. 

```{r setup}
rm(list=ls())
library(tidyverse)
library(lubridate)
library(readxl)
source("Piedras_Blancas_fcns.R")

data.dir <- "data/All data/"
#out.dir <- "data/Processed data/"    # completed in May 2022 but needs revisions
out.dir <- "data/Processed data v2/"  # for revising outputs
out.formatted.dir <- "data/Formatted Annual Data v2/"

# Regardless of if output file exists, this will overwrite the output files
save.files <- TRUE

```

Event code:
1 = START EFFORT
2 = CHANGE OBSERVERS
3 = CHANGE SIGHTING CONDITIONS
4 = GRAY WHALE SIGHTING
5 = END EFFORT
6 = OTHER SPECIES SIGHTING


THIS FILE NEEDS TO BE UPDATED AND ANNOTATED BETTER. EACH YEAR HAS A DIFFERENT FORMAT SO ALL THE DIFFERENCES NEED TO BE DESCRIBED IN DETAILS. COMMON FUNCTIONS MAY NOT WORK SO WELL. CURRENTLY IT DOES NOT RUN. 2022-07-27

2023-05-09 WHEN THERE ARE ONLY 4 SHIFTS, BUT DATA EXTRACTION WAS SET TO 5 SHIFTS, THE LAST SHIFT GETS FULL 3 HOURS EVEN THOUGH THERE WERE NO EFFORT. THIS NEEDS TO BE FIXED IN THE get.data FUNCTION. 

## 1994

```{r}
Year <- 1994
# Inshore
# G665 ?? deleted in Cow / Calf column 2023-05-08
# C1164 Changed 130 to 730 in Time column 2023-05-08
# C1508 Changed 155 to 1155 in Time column 2023-05-08

# Offshore
# C509 Changed 328 to 628 in Time column 2023-05-08


dir.name <- paste0("C_C ", Year)
start.time <- "630"

xls.files <- list.files(path = paste0(data.dir, dir.name), pattern = ".xls")
xls.file.name.inshore <- paste0(data.dir, dir.name, "/", xls.files[1])
xls.file.name.offshore <- paste0(data.dir, dir.name, "/", xls.files[2])

# sheet.name.inshore <- "INSHORE LOG"
# sheet.name.offshore <- NULL
# col.types.inshore <- c("date", "numeric", "text", "numeric", "text",
#                        "text", "numeric", "text", "text")
# 
# col.names.inshore <- c("Date", "Event", "Time", "Obs. Code", "Sea State",
#                        "Vis. IN", "Cow  / Calf")
# 
# col.types.offshore <- c("date", "numeric", "text", "numeric", "text",
#                         "text", "numeric", "numeric", "text", "text")
# 
# col.names.offshore <- c("Date", "Event", "Time", "Obs.", "Sea State",
#                         "Vis. Code", "Cow/Calf")

out.list <- get.all.data(list.sheet.name.inshore$Y1994, 
                         list.sheet.name.offshore$Y1994,
                         list.col.types.inshore$Y1994, 
                         list.col.types.offshore$Y1994,
                         list.col.names.inshore$Y1994, 
                         list.col.names.offshore$Y1994,
                         Year, 
                         xls.file.name.inshore, xls.file.name.offshore,
                         start.time)

if (save.files){
  # Creates file names and saves files
  files <- file.names(out.dir, Year, out.list)
  
}


```


## 1995

```{r}
# Inshore:
# D1056, D1064 Observer code SN, changed to 11
# D1069, D1080 Observer code steph, changed to 12 
# Row 1221 TOTALS 189 (col H), 72 (col I), 57 (col J) deleted.

# Offshore:
# D740, D747 Observer code SN, changed to 11
# D752, D760 Observer code steph, changed to 12 

Year <- 1995
dir.name <- paste0("C_C ", Year)
start.time <- "700"
xls.files <- list.files(path = paste0(data.dir, dir.name), pattern = ".xls")
xls.file.name.inshore <- paste0(data.dir, dir.name, "/", xls.files[1])
xls.file.name.offshore <- paste0(data.dir, dir.name, "/", xls.files[2])

sheet.name.inshore <- "Inshore Data"
sheet.name.offshore <- "Offshore Data"
col.types.inshore <- c("date", "numeric", "text", "numeric", "text", 
                       "text", "numeric", "numeric", "text", "text", 
                       "text", "text", "text", "text", "text", "text")

col.names.inshore <- c("Date",	"Event Code",	"Time",	"Observer Code",	
                       "Sea State",	"Vis In",	"C/C Pairs")

col.types.offshore <- c("date", "numeric", "text", "numeric", 
                        "text", "text", "numeric", "numeric", 
                        "numeric", "text", "numeric", "text")

col.names.offshore <- c("Date",	"Event",	"Time",	"OBS.", 
                        "Sea", "Vis.", 	"Cow/Calf")

out.list <- get.all.data(sheet.name.inshore, sheet.name.offshore,
                         col.types.inshore, col.types.offshore,
                         col.names.inshore, col.names.offshore,
                         Year, 
                         xls.file.name.inshore, xls.file.name.offshore,
                         start.time)

if (save.files){
  # Creates file names and saves files
  files <- file.names(out.dir, Year, out.list)
  
}



```



## 1996


```{r}
# Inshore:
# Rows 1268-1283, DATE is 1/21/1996. Changed to 5/21/1996

# Offshore:
# Rows 611-625, DATE is 1/16/1996. Changed to 4/16/1996

Year <- 1996
dir.name <- paste0("C_C ", Year)
start.time <- "700"
xls.files <- list.files(path = paste0(data.dir, dir.name), pattern = ".xls")
xls.file.name.inshore <- paste0(data.dir, dir.name, "/", xls.files[1])
xls.file.name.offshore <- paste0(data.dir, dir.name, "/", xls.files[2])

# c("Date", "Event", "Time", "Obs. Code", 
# "Sea State", "Vis. IN", "Cow  / Calf")



# sheet.name.inshore <- "data"
# sheet.name.offshore <- "Sheet1"
# col.names.inshore <- c("DATE",	"EVENT CODE",	"TIME", "OBS.",	
#                        "SEA STATE",	"VIS (IN/OUT)",	"C/C")
# 
# col.types.inshore <- c("date", "numeric", "text", "numeric", 
#                        "text", "text", "numeric", "numeric", 
#                        "numeric", "text", "text", 
#                        "text", "text", "text")
# 
# 
# col.names.offshore <- c("DATE",	"EVENT CODE",	"TIME", 	"OBS",
#                        	"SEA ST.", "VIS",	"C/C")
# 
# col.types.offshore <- c("date", "numeric", "text", "numeric", 
#                         "text", "text", "numeric", "numeric", 
#                         "numeric", "text",  "text")

out.list <- get.all.data(sheet.name.inshore, sheet.name.offshore,
                         col.types.inshore, col.types.offshore,
                         col.names.inshore, col.names.offshore,
                         Year, 
                         xls.file.name.inshore, xls.file.name.offshore,
                         start.time)

if (save.files){
  # Creates file names and saves files
  files <- file.names(out.dir, Year, out.list)
  
}




```



## 1997

```{r}
# Inshore:
# Row 838 TIME was 100. Changed to 1100. 2023-05-08


Year <- 1997
dir.name <- paste0("C_C ", Year)
start.time <- "700"
xls.files <- list.files(path = paste0(data.dir, dir.name), pattern = ".xls")
xls.file.name.inshore <- paste0(data.dir, dir.name, "/", xls.files[1])
xls.file.name.offshore <- paste0(data.dir, dir.name, "/", xls.files[2])



sheet.name.inshore <- "LOGS"
sheet.name.offshore <- "LOGS"

col.names.inshore <- c("DATE",	"EVENT",	"TIME", "OBSER", 
                       "SEA STATE", "VIS I/O", "C/C")

col.types.inshore <- c("date", "numeric", "text", "numeric", "numeric", 
                       "numeric", "text", "text", "text", 
                       "text", "numeric", "text", "text", 
                       "text")

col.names.offshore <- c("DATE",	"EVENT CODE",	"TIME", "OBS",
                        "S STATE", "VIS", "COW/CA")

col.types.offshore <- c("date", "numeric", "text", "numeric", 
                        "numeric", "text", "text", "numeric", 
                        "text", "text",  "numeric", "text")

out.list <- get.all.data(sheet.name.inshore, sheet.name.offshore,
                         col.types.inshore, col.types.offshore,
                         col.names.inshore, col.names.offshore,
                         Year, 
                         xls.file.name.inshore, xls.file.name.offshore,
                         start.time)

if (save.files){
  # Creates file names and saves files
  files <- file.names(out.dir, Year, out.list)
  
}


```



## 1998 START HERE 2023-05-08

```{r}
# Inshore:
# Row 388 Time 100 has been changed to 1000 2023-05-09


Year <- 1998
dir.name <- paste0("C_C ", Year)
start.time <- "630"
xls.files <- list.files(path = paste0(data.dir, dir.name), pattern = ".xls")
xls.file.name.inshore <- paste0(data.dir, dir.name, "/", xls.files[1])
xls.file.name.offshore <- paste0(data.dir, dir.name, "/", xls.files[2])



sheet.name.inshore <- "LOG"
sheet.name.offshore <- "LOGS"

col.names.inshore <- c("Date",	"Event Code",	"Time",	"Obs",
                       "Vis (I/O)", "Sea State",	"c/c"	)

col.types.inshore <- c("date", "numeric", "text", "numeric", 
                       "text", "text", "numeric", "numeric", 
                       "numeric", "text", "text", "text", 
                       "text", "text")

col.names.offshore <- c("Date",	"Event Code",	"Time",	"Obs",	
                        "Vis",	"SeaState",	"c/c")

col.types.offshore <- c("date", "numeric", "text", "numeric", 
                        "text", "text", "numeric", "numeric", 
                        "text", "text",  "text", "text")
  
out.list <- get.all.data(sheet.name.inshore, sheet.name.offshore,
                         col.types.inshore, col.types.offshore,
                         col.names.inshore, col.names.offshore,
                         Year, 
                         xls.file.name.inshore, xls.file.name.offshore,
                         start.time)

if (save.files){
  # Creates file names and saves files
  files <- file.names(out.dir, Year, out.list)
  
}



```




## 1999

```{r}
# Inshore:
# Row 395 Time = 100, changed to 1200 2023-05-09

# Offshore
# Row 997 Time = 100. changed to 1300 2023-05-09

Year <- 1999
dir.name <- paste0("C_C ", Year)
start.time <- "630"
xls.files <- list.files(path = paste0(data.dir, dir.name), pattern = ".xls")
xls.file.name.inshore <- paste0(data.dir, dir.name, "/", xls.files[1])
xls.file.name.offshore <- paste0(data.dir, dir.name, "/", xls.files[2])

sheet.name.inshore <- "DATA"
sheet.name.offshore <- "DATA"

col.names.inshore <- c("Date",	"Event Code",	"Time", 	"Obs. Code",
                       "Vis", "Sea State", "C/C")

col.types.inshore <- c("date", "numeric", "text", "numeric", 
                       "text", "text", "numeric", "numeric", 
                       "numeric", "text", "text", "text",
                       "text", "text", "text")

col.names.offshore <- c("Date",	"Event Code",	"Time",	"Observer",	
                        "Vis. Code",	"Sea State",	"C/C")

col.types.offshore <- c("date", "numeric", "text", "numeric", 
                        "text", "text", "numeric", "numeric", 
                        "text", "text",  "text", "text")



out.list <- get.all.data(sheet.name.inshore, sheet.name.offshore,
                         col.types.inshore, col.types.offshore,
                         col.names.inshore, col.names.offshore,
                         Year, 
                         xls.file.name.inshore, xls.file.name.offshore,
                         start.time)

if (save.files){
  # Creates file names and saves files
  files <- file.names(out.dir, Year, out.list)
  
}


```



## 2000

```{r}
Year <- 2000
dir.name <- paste0("C_C ", Year)
start.time <- "630"
xls.files <- list.files(path = paste0(data.dir, dir.name), pattern = ".xls")
xls.file.name.inshore <- paste0(data.dir, dir.name, "/", xls.files[1])
xls.file.name.offshore <- paste0(data.dir, dir.name, "/", xls.files[2])

sheet.name.inshore <- "DATA"
sheet.name.offshore <- "LOGS"

col.names.inshore <- c("DATE",	"EVENT",	"TIME",	"OBS.",	
                       "VIS (IN/OUT)",	"SEA STATE",	"C/C")

col.types.inshore <- c("date", "numeric", "text", "numeric", 
                       "text", "text", "numeric", "numeric", 
                       "text", "text", "text", "text",
                       "text", "text")

col.names.offshore <- c("DATE",	"EVENT",	"TIME",	"OBS.",
                        "VIS CODE",	"SEA STATE",	"C/C")

col.types.offshore <- c("date", "numeric", "text", "numeric", 
                        "text", "text", "numeric", "numeric", 
                        "text", "text",  "text")



out.list <- get.all.data(sheet.name.inshore, sheet.name.offshore,
                         col.types.inshore, col.types.offshore,
                         col.names.inshore, col.names.offshore,
                         Year, 
                         xls.file.name.inshore, xls.file.name.offshore,
                         start.time)

if (save.files){
  # Creates file names and saves files
  files <- file.names(out.dir, Year, out.list)
  
}



```



## 2001

```{r}
# Inshore:
# Row 838 Time = 8.3. Changed to 830. 2023-05-09


# Offshore:
# Row 898 Time = 147. Changed to 1547. 2023-05-09
# Row 458 Time = 13321. Changed to 1332. 2023-05-09
# Row 921 Time = 130. Changed to 1730 (could be 1830). 2023-05-09


Year <- 2001
dir.name <- paste0("C_C ", Year)
start.time <- "700"
xls.files <- list.files(path = paste0(data.dir, dir.name), pattern = ".xls")
xls.file.name.inshore <- paste0(data.dir, dir.name, "/", xls.files[1])
xls.file.name.offshore <- paste0(data.dir, dir.name, "/", xls.files[2])

sheet.name.inshore <- "LOGS"
sheet.name.offshore <- "LOGS"

col.names.inshore <- c("DATE",	"EVENT",	"TIME",	"OBS.",
                       "VIS I/O",	"SEA ST",	"C/C"	)

col.types.inshore <- c("date", "numeric", "text", "numeric", 
                       "text", "text", "numeric", "numeric", 
                       "text", "text", "text", "text",
                       "text", "text")

col.names.offshore <- c("DATE",	"EVENT",	"TIME",	"OBS",
                        "VIS",	"SEA STATE",	"C/C")

col.types.offshore <- c("date", "numeric", "text", "numeric", 
                        "text", "text", "numeric", "numeric", 
                        "text", "text",  "text", "text")



out.list <- get.all.data(sheet.name.inshore, sheet.name.offshore,
                         col.types.inshore, col.types.offshore,
                         col.names.inshore, col.names.offshore,
                         Year, 
                         xls.file.name.inshore, xls.file.name.offshore,
                         start.time)

if (save.files){
  # Creates file names and saves files
  files <- file.names(out.dir, Year, out.list)
  
}


```



## 2002

```{r}
Year <- 2002
dir.name <- paste0("C_C ", Year)
start.time <- "630"
xls.files <- list.files(path = paste0(data.dir, dir.name), pattern = ".xls")
xls.file.name.inshore <- paste0(data.dir, dir.name, "/", xls.files[1])
xls.file.name.offshore <- paste0(data.dir, dir.name, "/", xls.files[2])

sheet.name.inshore <- "LOGS"
sheet.name.offshore <- "LOG"

col.names.inshore <- c("DATE",	"EVENT",	"TIME", 	"OBS",
                       "VIS (I/O)",	"SS",	"C/C")

col.types.inshore <- c("date", "numeric", "text", "numeric", 
                       "text", "text", "numeric", "numeric", 
                       "text", "text", "text", "text",
                       "text", "text")

col.names.offshore <- c("DATE",	"EVENT",	"TIME",	"OBS",
                        "VIS",	"SS",	"C/C")

col.types.offshore <- c("date", "numeric", "text", "numeric", 
                        "text", "text", "numeric", "numeric", 
                        "text", "text",  "text", "text")



out.list <- get.all.data(sheet.name.inshore, sheet.name.offshore,
                         col.types.inshore, col.types.offshore,
                         col.names.inshore, col.names.offshore,
                         Year, 
                         xls.file.name.inshore, xls.file.name.offshore,
                         start.time)

if (save.files){
  # Creates file names and saves files
  files <- file.names(out.dir, Year, out.list)
  
}


```



## 2003

```{r}
# Inshore:
# Row 368. Time = 700. Changed to 900.

Year <- 2003
dir.name <- paste0("C_C ", Year)
start.time <- "630"
xls.files <- list.files(path = paste0(data.dir, dir.name), pattern = ".xls")
xls.file.name.inshore <- paste0(data.dir, dir.name, "/", xls.files[1])
xls.file.name.offshore <- paste0(data.dir, dir.name, "/", xls.files[2])

sheet.name.inshore <- "Logs"
sheet.name.offshore <- "logs"

col.names.inshore <- c("DATE",	"EVENT",	"TIME", 	"OBS",
                       "VIS (I/O)",	"SS",	"C/C")

col.types.inshore <- c("date", "numeric", "text", "numeric", 
                       "text", "text", "numeric", "numeric", 
                       "text", "text", "text", "text",
                       "text", "text")

col.names.offshore <- c("DATE",	"EVENT",	"TIME",	"OBS",
                        "VIS",	"SS",	"C/C")

col.types.offshore <- c("date", "numeric", "text", "numeric", 
                        "text", "text", "numeric", "numeric", 
                        "text", "text",  "text", "text")



out.list <- get.all.data(sheet.name.inshore, sheet.name.offshore,
                         col.types.inshore, col.types.offshore,
                         col.names.inshore, col.names.offshore,
                         Year, 
                         xls.file.name.inshore, xls.file.name.offshore,
                         start.time)

if (save.files){
  # Creates file names and saves files
  files <- file.names(out.dir, Year, out.list)
  
}



```



## 2004

```{r}
Year <- 2004
dir.name <- paste0("C_C ", Year)
start.time <- "630"
xls.files <- list.files(path = paste0(data.dir, dir.name), pattern = ".xls")
xls.file.name.inshore <- paste0(data.dir, dir.name, "/", xls.files[2])
xls.file.name.offshore <- paste0(data.dir, dir.name, "/", xls.files[3])

sheet.name.inshore <- "DATA"
sheet.name.offshore <- "DATA"

col.names.inshore <- c("DATE",	"EVENT",	"TIME", 	"OBS",
                       "VIS (I/O)",	"SS",	"C/C")

col.types.inshore <- c("date", "numeric", "text", "numeric", 
                       "text", "text", "numeric", "numeric", 
                       "text", "text", "text", "text",
                       "text", "text")

col.names.offshore <- c("DATE",	"EVENT",	"TIME",	"OBS",	
                        "VIS",	"SS",	"C/C")

col.types.offshore <- c("date", "numeric", "text", "numeric", 
                        "text", "text", "numeric", "numeric", 
                        "text", "text",  "text", "text")



out.list <- get.all.data(sheet.name.inshore, sheet.name.offshore,
                         col.types.inshore, col.types.offshore,
                         col.names.inshore, col.names.offshore,
                         Year, 
                         xls.file.name.inshore, xls.file.name.offshore,
                         start.time)


if (save.files){
  # Creates file names and saves files
  files <- file.names(out.dir, Year, out.list)
  
}


```



## 2005

```{r}
Year <- 2005
dir.name <- paste0("C_C ", Year)
start.time <- "630"
xls.files <- list.files(path = paste0(data.dir, dir.name), pattern = ".xls")
xls.file.name.inshore <- paste0(data.dir, dir.name, "/", xls.files[1])
xls.file.name.offshore <- paste0(data.dir, dir.name, "/", xls.files[2])


sheet.name.inshore <- "LOGS"
sheet.name.offshore <- "LOGS"

col.names.inshore <- c("DATE",	"EVENT",	"TIME", 	"OBS",
                       "VIS (I/O)",	"SS",	"C/C")

col.types.inshore <- c("date", "numeric", "text", "numeric", 
                       "text", "text", "numeric", "numeric", 
                       "text", "text", "text", "text", 
                       "text", "text")

col.names.offshore <- c("DATE",	"EVENT",	"TIME",	"OBS",	
                        "VIS",	"SS",	"C/C")

col.types.offshore <- c("date", "numeric", "text", "numeric", 
                        "text", "text", "numeric", "numeric", 
                        "text", "text",  "text", "text")



out.list <- get.all.data(sheet.name.inshore, sheet.name.offshore,
                         col.types.inshore, col.types.offshore,
                         col.names.inshore, col.names.offshore,
                         Year, 
                         xls.file.name.inshore, xls.file.name.offshore,
                         start.time)

if (save.files){
  # Creates file names and saves files
  files <- file.names(out.dir, Year, out.list)
  
}


```




## 2006

```{r}
# Offshore:
# Row 437 Time = 9.9. Changed to 939. 3 is closest to decimal point. 2023-05-09

Year <- 2006
dir.name <- paste0("C_C ", Year)
start.time <- "630"
xls.files <- list.files(path = paste0(data.dir, dir.name), pattern = ".xls")
xls.file.name.inshore <- paste0(data.dir, dir.name, "/", xls.files[1])
xls.file.name.offshore <- paste0(data.dir, dir.name, "/", xls.files[2])

sheet.name.inshore <- "LOGS"
sheet.name.offshore <- "LOGS"

col.names.inshore <- c("DATE",	"EVENT", 	"TIME",	"OBS#",
                       "VIS IN",	"SEA ST",	"C/C")

col.types.inshore <- c("date", "numeric", "text", "numeric", 
                       "text", "text", "numeric", "numeric", 
                       "text", "text", "text", "text", 
                       "text", "text", "text")

col.names.offshore <- c("DATE",	"EVENT",	"TIME",	"OBS",	
                        "VIS",	"SEA ST",	"C/C")

col.types.offshore <- c("date", "numeric", "text", "numeric", 
                        "text", "text", "numeric", "numeric", 
                        "text", "text",  "text", "text")



out.list <- get.all.data(sheet.name.inshore, sheet.name.offshore,
                         col.types.inshore, col.types.offshore,
                         col.names.inshore, col.names.offshore,
                         Year, 
                         xls.file.name.inshore, xls.file.name.offshore,
                         start.time)

if (save.files){
  # Creates file names and saves files
  files <- file.names(out.dir, Year, out.list)
  
}



```



## 2007

```{r}
Year <- 2007
dir.name <- paste0("C_C ", Year)
start.time <- "700"
xls.files <- list.files(path = paste0(data.dir, dir.name), pattern = ".xls")
xls.file.name.inshore <- paste0(data.dir, dir.name, "/", xls.files[1])
xls.file.name.offshore <- paste0(data.dir, dir.name, "/", xls.files[2])

sheet.name.inshore <- "log"
sheet.name.offshore <- "log"

col.names.inshore <- c("DATE",	"EVENT", 	"TIME",	"OBS#",
                       "VIS IN",	"SEA ST",	"C/C")

col.types.inshore <- c("date", "numeric", "text", "numeric", 
                       "text", "text", "numeric", "numeric", 
                       "text", "text", "text", "text", 
                       "text", "text", "text", "text")

col.names.offshore <- c("DATE",	"EVENT",	"TIME",	"OBS",	
                        "VIS",	"SEA ST",	"C/C")

col.types.offshore <- c("date", "numeric", "text", "numeric", 
                        "text", "text", "numeric", "numeric", 
                        "text", "text",  "text", "text")


out.list <- get.all.data(sheet.name.inshore, sheet.name.offshore,
                         col.types.inshore, col.types.offshore,
                         col.names.inshore, col.names.offshore,
                         Year, 
                         xls.file.name.inshore, xls.file.name.offshore,
                         start.time)

if (save.files){
  # Creates file names and saves files
  files <- file.names(out.dir, Year, out.list)
  
}


```




## 2008

```{r}
Year <- 2008
dir.name <- paste0("C_C ", Year)
start.time <- "700"
xls.files <- list.files(path = paste0(data.dir, dir.name), pattern = ".xls")
xls.file.name.inshore <- paste0(data.dir, dir.name, "/", xls.files[1])
xls.file.name.offshore <- paste0(data.dir, dir.name, "/", xls.files[2])

sheet.name.inshore <- "LOG"
sheet.name.offshore <- "LOGS"

col.names.inshore <- c("DATE",	"EVENT", 	"TIME",	"OBS#",
                       "VIS IN",	"SEA ST",	"C/C")

col.types.inshore <- c("date", "numeric", "text", "numeric", 
                       "text", "text", "numeric", "numeric", 
                       "text", "text", "text", "text", 
                       "text", "text", "text")

col.names.offshore <- c("DATE",	"EVENT",	"TIME",	"OBS",	
                        "VIS",	"SEA ST",	"C/C")

col.types.offshore <- c("date", "numeric", "text", "numeric", 
                        "text", "text", "numeric", "numeric", 
                        "text", "text",  "text", "text")




out.list <- get.all.data(sheet.name.inshore, sheet.name.offshore,
                         col.types.inshore, col.types.offshore,
                         col.names.inshore, col.names.offshore,
                         Year, 
                         xls.file.name.inshore, xls.file.name.offshore,
                         start.time)

if (save.files){
  # Creates file names and saves files
  files <- file.names(out.dir, Year, out.list)
  
}


```


## 2009

```{r}
Year <- 2009
dir.name <- paste0("C_C ", Year)
start.time <- "700"
xls.files <- list.files(path = paste0(data.dir, dir.name), pattern = ".xls")
xls.file.name.inshore <- paste0(data.dir, dir.name, "/", xls.files[1])
xls.file.name.offshore <- paste0(data.dir, dir.name, "/", xls.files[2])

sheet.name.inshore <- "LOGS"
sheet.name.offshore <- "LOGS"

col.names.inshore <- c("DATE",	"EVENT", 	"TIME",	"OBS#",
                       "VIS IN",	"SEA ST",	"C/C")

col.types.inshore <- c("date", "numeric", "text", "numeric", 
                       "text", "text", "numeric", "numeric", 
                       "text", "text", "text", "text", 
                       "text", "text", "text")

col.names.offshore <- c("DATE",	"EVENT",	"TIME",	"OBS",	
                        "VIS",	"SEA ST",	"C/C")

col.types.offshore <- c("date", "numeric", "text", "numeric", 
                        "text", "text", "numeric", "numeric", 
                        "text", "text",  "text", "text")



out.list <- get.all.data(sheet.name.inshore, sheet.name.offshore,
                         col.types.inshore, col.types.offshore,
                         col.names.inshore, col.names.offshore,
                         Year, 
                         xls.file.name.inshore, xls.file.name.offshore,
                         start.time)

if (save.files){
  # Creates file names and saves files
  files <- file.names(out.dir, Year, out.list)
  
}


```


Files seem to be about the same from these years... 



## 2010

```{r}
Year <- 2010
dir.name <- paste0("C_C ", Year)
start.time <- "700"
xls.files <- list.files(path = paste0(data.dir, dir.name), pattern = ".xls")
xls.file.name.inshore <- paste0(data.dir, dir.name, "/", xls.files[2])
xls.file.name.offshore <- paste0(data.dir, dir.name, "/", xls.files[3])

sheet.name.inshore <- "LOGS"
sheet.name.offshore <- "LOGS"

col.names.inshore <- c("DATE",	"EVENT", 	"TIME",	"OBS#",
                       "VIS IN",	"SEA ST",	"C/C")

col.types.inshore <- c("date", "numeric", "text", "numeric", 
                       "text", "text", "numeric", "numeric", 
                       "text", "text", "text", "text", 
                       "text", "text", "text")

col.names.offshore <- c("DATE",	"EVENT",	"TIME",	"OBS",	
                        "VIS",	"SEA ST",	"C/C")

col.types.offshore <- c("date", "numeric", "text", "numeric", 
                        "text", "text", "numeric", "numeric", 
                        "text", "text",  "text", "text")



out.list <- get.all.data(sheet.name.inshore, sheet.name.offshore,
                         col.types.inshore, col.types.offshore,
                         col.names.inshore, col.names.offshore,
                         Year, 
                         xls.file.name.inshore, xls.file.name.offshore,
                         start.time)

if (save.files){
  # Creates file names and saves files
  files <- file.names(out.dir, Year, out.list)
  
}


```



## 2011

```{r}
Year <- 2011
dir.name <- paste0("C_C ", Year)
start.time <- "700"
xls.files <- list.files(path = paste0(data.dir, dir.name), pattern = ".xls")
xls.file.name.inshore <- paste0(data.dir, dir.name, "/", xls.files[2])
xls.file.name.offshore <- paste0(data.dir, dir.name, "/", xls.files[3])

sheet.name.inshore <- "LOGS"
sheet.name.offshore <- "LOGS"

col.names.inshore <- c("DATE",	"EVENT", 	"TIME",	"OBS#",
                       "VIS IN",	"SEA ST",	"C/C")

col.types.inshore <- c("date", "numeric", "text", "numeric", 
                       "text", "text", "numeric", "numeric", 
                       "text", "text", "text", "text", 
                       "text", "text", "text")

col.names.offshore <- c("DATE",	"EVENT",	"TIME",	"OBS",	
                        "VIS",	"SEA ST",	"C/C")

col.types.offshore <- c("date", "numeric", "text", "numeric", 
                        "text", "text", "numeric", "numeric", 
                        "text", "text",  "text", "text")



out.list <- get.all.data(sheet.name.inshore, sheet.name.offshore,
                         col.types.inshore, col.types.offshore,
                         col.names.inshore, col.names.offshore,
                         Year, 
                         xls.file.name.inshore, xls.file.name.offshore,
                         start.time)

if (save.files){
  # Creates file names and saves files
  files <- file.names(out.dir, Year, out.list)
  
}



```



## 2012

```{r}
# Inshore:
# Row 311 TIME = 100. Changed to 1600. 2023-05-09

Year <- 2012
dir.name <- paste0("C_C ", Year)
start.time <- "700"
xls.files <- list.files(path = paste0(data.dir, dir.name), pattern = ".xls")
xls.file.name.inshore <- paste0(data.dir, dir.name, "/", xls.files[2])
xls.file.name.offshore <- paste0(data.dir, dir.name, "/", xls.files[3])

sheet.name.inshore <- "LOGS"
sheet.name.offshore <- "LOGS"

col.names.inshore <- c("DATE",	"EVENT", 	"TIME",	"OBS#",
                       "VIS IN",	"SEA ST",	"C/C")

col.types.inshore <- c("date", "numeric", "text", "numeric", 
                       "text", "text", "numeric", "numeric", 
                       "text", "text", "text", "text", 
                       "text", "text", "text")

col.names.offshore <- c("DATE",	"EVENT",	"TIME",	"OBS",	
                        "VIS",	"SEA ST",	"C/C")



out.list <- get.all.data(sheet.name.inshore, sheet.name.offshore,
                         col.types.inshore, col.types.offshore,
                         col.names.inshore, col.names.offshore,
                         Year, 
                         xls.file.name.inshore, xls.file.name.offshore,
                         start.time)

if (save.files){
  # Creates file names and saves files
  files <- file.names(out.dir, Year, out.list)
  
}


```



## 2013

```{r}
# Inshore:
# Row 613 Time = 741. Changed to 941. 2023-05-11

# Offshore:
# Row 450 TIME = 100. Changed to 1600. 2023-05-09

Year <- 2013
dir.name <- paste0("C_C ", Year)
start.time <- "700"
xls.files <- list.files(path = paste0(data.dir, dir.name), pattern = ".xls")
xls.file.name.inshore <- paste0(data.dir, dir.name, "/", xls.files[1])
xls.file.name.offshore <- paste0(data.dir, dir.name, "/", xls.files[2])

sheet.name.inshore <- "LOGS"
sheet.name.offshore <- "LOGS"

col.names.inshore <- c("DATE",	"EVENT", 	"TIME",	"OBS#",
                       "VIS IN",	"SEA ST",	"C/C")

col.types.inshore <- c("date", "numeric", "text", "numeric", 
                       "text", "text", "numeric", "numeric", 
                       "text", "text", "text", "text", 
                       "text", "text", "text")

col.names.offshore <- c("DATE",	"EVENT",	"TIME",	"OBS",	
                        "VIS",	"SEA ST",	"C/C")

col.types.offshore <- c("date", "numeric", "text", "numeric", 
                        "text", "text", "numeric", "numeric", 
                        "text", "text",  "text", "text")

col.types.offshore <- c("date", "numeric", "text", "numeric", 
                        "text", "text", "numeric", "numeric", 
                        "text", "text",  "text", "text")

START HERE TO COMPLETE THE FOLLOWING LISTS TO CLEAN UP THE CODE. 2023-05-12

list.sheet.names.inshore <- list(Y1994 = "INSHORE LOG", Y1995 = "Inshore Data", Y1996 = "data",
                                 Y1997 = "LOGS", Y1998 = "LOGS", Y1999 = "DATA",
                                 Y2000 = "DATA", Y2001 = "LOGS", Y2002 = "LOGS",
                                 Y2003 = "logs", Y2004 = "DATA", Y2005 = "LOGS",
                                 Y2006 = "LOGS", Y2007 = "log", Y2008 = "LOG",
                                 Y2009 = "LOGS", Y2010 = "LOGS", Y2011 = "LOGS",
                                 Y2012 = "LOGS")
list.sheet.names.offshore <- list(Y1994 = NULL, Y1995 = "Offshore Data", Y1996 = "Sheet1",
                                  Y1997 = "LOGS", Y1998 = "LOGS", Y1999 = "DATA",
                                  Y2000 = "LOGS", Y2001 = "LOGS", Y2002 = "LOG",
                                  Y2003 = "logs", Y2004 = "DATA", Y2005 = "LOGS",
                                  Y2006 = "LOGS", Y2007 = "log", Y2008 = "LOGS",
                                  Y2009 = "LOGS", Y2010 = "LOGS", Y2011 = "LOGS",
                                  Y2012 = "LOGS")
list.col.types.inshore <- list(Y1994 = c("date", "numeric", "text", "numeric", "text",
                                         "text", "numeric", "text", "text"),
                               Y1995 = c("date", "numeric", "text", "numeric", "text", 
                                         "text", "numeric", "numeric", "text", "text", 
                                         "text", "text", "text", "text", "text", "text"),
                               Y1996 = c("date", "numeric", "text", "numeric", 
                                         "text", "text", "numeric", "numeric", 
                                         "numeric", "text", "text", 
                                         "text", "text", "text"),
                               Y1997 = c("date", "numeric", "text", "numeric", "numeric", 
                                         "numeric", "text", "text", "text", 
                                         "text", "numeric", "text", "text", 
                                         "text"),
                               Y1998 = c("date", "numeric", "text", "numeric", 
                                         "text", "text", "numeric", "numeric", 
                                         "numeric", "text", "text", "text", 
                                         "text", "text"),
                               Y1999 = c("date", "numeric", "text", "numeric", 
                                         "text", "text", "numeric", "numeric", 
                                         "numeric", "text", "text", "text",
                                         "text", "text", "text"),
                               Y2000 = c("date", "numeric", "text", "numeric", 
                                         "text", "text", "numeric", "numeric", 
                                         "text", "text", "text", "text",
                                         "text", "text"),
                               Y2001 = c("date", "numeric", "text", "numeric", 
                                         "text", "text", "numeric", "numeric", 
                                         "text", "text", "text", "text",
                                         "text", "text"),
                               Y2002 =  c("date", "numeric", "text", "numeric", 
                                          "text", "text", "numeric", "numeric", 
                                          "text", "text", "text", "text",
                                          "text", "text"),
                               Y2003 = c("date", "numeric", "text", "numeric", 
                                         "text", "text", "numeric", "numeric", 
                                         "text", "text", "text", "text",
                                         "text", "text"),
                               Y2004 = c("date", "numeric", "text", "numeric", 
                                         "text", "text", "numeric", "numeric", 
                                         "text", "text", "text", "text",
                                         "text", "text"),
                               Y2005 = c("date", "numeric", "text", "numeric", 
                                         "text", "text", "numeric", "numeric", 
                                         "text", "text", "text", "text", 
                                         "text", "text"),
                               Y2006 = c("date", "numeric", "text", "numeric", 
                                         "text", "text", "numeric", "numeric", 
                                         "text", "text", "text", "text", 
                                         "text", "text", "text"),
                               Y2007 = c("date", "numeric", "text", "numeric", 
                                         "text", "text", "numeric", "numeric", 
                                         "text", "text", "text", "text", 
                                         "text", "text", "text", "text"),
                               Y2008 = c("date", "numeric", "text", "numeric", "text", "text", "numeric", "numeric", 
                                         "text", "text", "text", "text", "text", "text", "text"),
                               Y2009 = c("date", "numeric", "text", "numeric", "text", "text", "numeric", "numeric", 
                                         "text", "text", "text", "text", "text", "text", "text"),
                               Y2010 = c("date", "numeric", "text", "numeric", 
                                         "text", "text", "numeric", "numeric", 
                                         "text", "text", "text", "text", 
                                         "text", "text", "text"),
                               Y2011 =  c("date", "numeric", "text", "numeric", 
                                          "text", "text", "numeric", "numeric", 
                                          "text", "text", "text", "text", 
                                          "text", "text", "text"),
                               Y2012 = c("date", "numeric", "text", "numeric", 
                                         "text", "text", "numeric", "numeric", 
                                         "text", "text", "text", "text", 
                                         "text", "text", "text"))
list.col.types.offshore <- list(Y1994 = c("date", "numeric", "text", "numeric", "text",
                                          "text", "numeric", "numeric", "text", "text"),
                                Y1995 = c("date", "numeric", "text", "numeric", 
                                          "text", "text", "numeric", "numeric", 
                                          "numeric", "text", "numeric", "text"),
                                Y1996 =  c("date", "numeric", "text", "numeric", 
                                           "text", "text", "numeric", "numeric", 
                                           "numeric", "text",  "text"),
                                Y1997 = c("date", "numeric", "text", "numeric", 
                                          "numeric", "text", "text", "numeric", 
                                          "text", "text",  "numeric", "text"),
                                Y1998 = c("date", "numeric", "text", "numeric", 
                                          "text", "text", "numeric", "numeric", 
                                          "text", "text",  "text", "text"),
                                Y1999 = c("date", "numeric", "text", "numeric", 
                                          "text", "text", "numeric", "numeric", 
                                          "text", "text",  "text", "text"),
                                Y2000 = c("date", "numeric", "text", "numeric", 
                                          "text", "text", "numeric", "numeric", 
                                          "text", "text",  "text"),
                                Y2001 =  c("date", "numeric", "text", "numeric", 
                                           "text", "text", "numeric", "numeric", 
                                           "text", "text",  "text", "text"),
                                Y2002 = c("date", "numeric", "text", "numeric", 
                                          "text", "text", "numeric", "numeric", 
                                          "text", "text",  "text", "text"),
                                Y2003 =  c("date", "numeric", "text", "numeric", 
                                           "text", "text", "numeric", "numeric", 
                                           "text", "text",  "text", "text"),
                                Y2004 = c("date", "numeric", "text", "numeric", 
                                          "text", "text", "numeric", "numeric", 
                                          "text", "text",  "text", "text"),
                                Y2005 = c("date", "numeric", "text", "numeric", 
                                          "text", "text", "numeric", "numeric", 
                                          "text", "text",  "text", "text"),
                                Y2006 =  c("date", "numeric", "text", "numeric", 
                                           "text", "text", "numeric", "numeric", 
                                           "text", "text",  "text", "text"),
                                Y2007 = c("date", "numeric", "text", "numeric", 
                                          "text", "text", "numeric", "numeric", 
                                          "text", "text",  "text", "text"),
                                Y2008 = c("date", "numeric", "text", "numeric", 
                                          "text", "text", "numeric", "numeric", 
                                          "text", "text",  "text", "text"),
                                Y2009 = c("date", "numeric", "text", "numeric", 
                                          "text", "text", "numeric", "numeric", 
                                          "text", "text",  "text", "text"),
                                Y2010 = c("date", "numeric", "text", "numeric", 
                                          "text", "text", "numeric", "numeric", 
                                          "text", "text",  "text", "text"),
                                Y2011 =  c("date", "numeric", "text", "numeric", 
                                           "text", "text", "numeric", "numeric", 
                                           "text", "text",  "text", "text"),
                                Y2012 =  c("date", "numeric", "text", "numeric", 
                                           "text", "text", "numeric", "numeric", 
                                           "text", "text",  "text", "text"))
list.col.names.inshore <- list(Y1994 = c("Date", "Event", "Time", "Obs. Code", "Sea State",
                                         "Vis. IN", "Cow  / Calf"),
                               Y1995 = c("Date",	"Event Code",	"Time",	"Observer Code",	
                                         "Sea State",	"Vis In",	"C/C Pairs"),
                               Y1996 = c("DATE",	"EVENT CODE",	"TIME", "OBS.",	
                                         "SEA STATE",	"VIS (IN/OUT)",	"C/C"),
                               Y1997 = c("DATE",	"EVENT",	"TIME", "OBSER", 
                                         "SEA STATE", "VIS I/O", "C/C"),
                               Y1998 = c("Date",	"Event Code",	"Time",	"Obs",
                                         "Vis (I/O)", "Sea State",	"c/c"	),
                               Y1999 = c("Date",	"Event Code",	"Time", 	"Obs. Code",
                                         "Vis", "Sea State", "C/C"),
                               Y2000 = c("DATE",	"EVENT",	"TIME",	"OBS.",	"VIS (IN/OUT)",	"SEA STATE",	"C/C"),
                               Y2001 = c("DATE",	"EVENT",	"TIME",	"OBS.", "VIS I/O",	"SEA ST",	"C/C"	),
                               Y2002 = c("DATE",	"EVENT",	"TIME", 	"OBS", "VIS (I/O)",	"SS",	"C/C"),
                               Y2003 = c("DATE",	"EVENT",	"TIME", 	"OBS", "VIS (I/O)",	"SS",	"C/C"),
                               Y2004 = c("DATE",	"EVENT",	"TIME", 	"OBS", "VIS (I/O)",	"SS",	"C/C"),
                               Y2005 = c("DATE",	"EVENT",	"TIME", 	"OBS", "VIS (I/O)",	"SS",	"C/C"),
                               Y2006 =  c("DATE",	"EVENT", 	"TIME",	"OBS#", "VIS IN",	"SEA ST",	"C/C"),
                               Y2007 = c("DATE",	"EVENT", 	"TIME",	"OBS#", "VIS IN",	"SEA ST",	"C/C"),
                               Y2008 = c("DATE",	"EVENT", 	"TIME",	"OBS#", "VIS IN",	"SEA ST",	"C/C"),
                               Y2009 =  c("DATE",	"EVENT", 	"TIME",	"OBS#", "VIS IN",	"SEA ST",	"C/C"),
                               Y2010 = c("DATE",	"EVENT", 	"TIME",	"OBS#", "VIS IN",	"SEA ST",	"C/C"),
                               Y2011 = c("DATE",	"EVENT", 	"TIME",	"OBS#", "VIS IN",	"SEA ST",	"C/C"),
                               Y2012 = c("DATE",	"EVENT", 	"TIME",	"OBS#", "VIS IN",	"SEA ST",	"C/C"))
list.col.names.offshore <- list(Y1994 = c("Date", "Event", "Time", "Obs.", "Sea State",
                                          "Vis. Code", "Cow/Calf"),
                                Y1995 = c("Date",	"Event",	"Time",	"OBS.", 
                                          "Sea", "Vis.", 	"Cow/Calf"),
                                Y1996 = c("DATE",	"EVENT CODE",	"TIME", 	"OBS",
                                          "SEA ST.", "VIS",	"C/C"),
                                Y1997 = c("DATE",	"EVENT CODE",	"TIME", "OBS",
                                          "S STATE", "VIS", "COW/CA"),
                                Y1998 = c("Date",	"Event Code",	"Time",	"Obs",	
                                          "Vis",	"SeaState",	"c/c"),
                                Y1999 = c("Date",	"Event Code",	"Time",	"Observer",	
                                          "Vis. Code",	"Sea State",	"C/C"),
                                Y2000 = c("DATE",	"EVENT",	"TIME",	"OBS.",
                                          "VIS CODE",	"SEA STATE",	"C/C"),
                                Y2001 =  c("DATE",	"EVENT",	"TIME",	"OBS",
                                           "VIS",	"SEA STATE",	"C/C"),
                                Y2002 = c("DATE",	"EVENT",	"TIME",	"OBS", "VIS",	"SS",	"C/C"),
                                Y2003 = c("DATE",	"EVENT",	"TIME",	"OBS", "VIS",	"SS",	"C/C"),
                                Y2004 = c("DATE",	"EVENT",	"TIME",	"OBS", "VIS",	"SS",	"C/C"),
                                Y2005 = c("DATE",	"EVENT",	"TIME",	"OBS", "VIS",	"SS",	"C/C"),
                                Y2006 = c("DATE",	"EVENT",	"TIME",	"OBS", "VIS",	"SEA ST",	"C/C"),
                                Y2007 = c("DATE",	"EVENT",	"TIME",	"OBS", "VIS",	"SEA ST",	"C/C"),
                                Y2008 = c("DATE",	"EVENT",	"TIME",	"OBS", "VIS",	"SEA ST",	"C/C"),
                                Y2009 = c("DATE",	"EVENT",	"TIME",	"OBS", "VIS",	"SEA ST",	"C/C"),
                                Y2010 = c("DATE",	"EVENT",	"TIME",	"OBS", "VIS",	"SEA ST",	"C/C"),
                                Y2011 = c("DATE",	"EVENT",	"TIME",	"OBS", "VIS",	"SEA ST",	"C/C"),
                                Y2012 =  c("DATE", "EVENT",	"TIME",	"OBS", "VIS",	"SEA ST",	"C/C"))


out.list <- get.all.data(sheet.name.inshore, sheet.name.offshore,
                         col.types.inshore, col.types.offshore,
                         col.names.inshore, col.names.offshore,
                         Year, 
                         xls.file.name.inshore, xls.file.name.offshore,
                         start.time)

if (save.files){
  # Creates file names and saves files
  files <- file.names(out.dir, Year, out.list)
  
}


```



## 2014

```{r}
Year <- 2014
dir.name <- paste0("C_C ", Year)
start.time <- "700"
xls.files <- list.files(path = paste0(data.dir, dir.name), pattern = ".xls")

xls.file.name.inshore <- paste0(data.dir, dir.name, "/", xls.files[grep("INSHORE", xls.files)])
xls.file.name.offshore <- paste0(data.dir, dir.name, "/", xls.files[grep("OFFSHORE", xls.files)])

sheet.name.inshore <- "LOGS"
sheet.name.offshore <- "LOGS"

col.names.inshore <- c("DATE",	"EVENT", 	"TIME",	"OBS#",
                       "VIS IN",	"SEA ST",	"C/C", "IN/OFF")

col.types.inshore <- c("date", "numeric", "text", "numeric", 
                       "text", "text", "numeric", "numeric", 
                       "text", "text", "text", "text", 
                       "text", "text", "text")

col.names.offshore <- c("DATE",	"EVENT",	"TIME",	"OBS",	
                        "VIS",	"SEA ST",	"C/C")

col.types.offshore <- c("date", "numeric", "text", "numeric", 
                        "text", "text", "numeric", "numeric", 
                        "text", "text",  "text", "text")

out.list <- get.all.data(sheet.name.inshore, sheet.name.offshore,
                         col.types.inshore, col.types.offshore,
                         col.names.inshore, col.names.offshore,
                         Year, 
                         xls.file.name.inshore, xls.file.name.offshore,
                         start.time)

if (save.files){
  # Creates file names and saves files
  files <- file.names(out.dir, Year, out.list)
  
}



```


## 2015

```{r}
# Row 617 TIME = 100. Changed to 1000. 2023-05-09

Year <- 2015
dir.name <- paste0("C_C ", Year)
start.time <- "700"
xls.files <- list.files(path = paste0(data.dir, dir.name), pattern = ".xls")

xls.file.name.inshore <- paste0(data.dir, dir.name, "/", xls.files[grep("INSHORE", xls.files)])
xls.file.name.offshore <- paste0(data.dir, dir.name, "/", xls.files[grep("OFFSHORE", xls.files)])

sheet.name.inshore <- "LOGS"
sheet.name.offshore <- "LOGS"

col.names.inshore <- c("DATE",	"EVENT", 	"TIME",	"OBS#",
                       "VIS IN",	"SEA ST",	"C/C", "IN/OFF")

col.types.inshore <- c("date", "numeric", "text", "numeric", 
                       "text", "text", "numeric", "numeric", 
                       "text", "text", "text", "text", 
                       "text", "text", "text")

col.names.offshore <- c("DATE",	"EVENT",	"TIME",	"OBS",	
                        "VIS",	"SEA ST",	"C/C")

col.types.offshore <- c("date", "numeric", "text", "numeric", 
                        "text", "text", "numeric", "numeric", 
                        "text", "text",  "text", "text")

out.list <- get.all.data(sheet.name.inshore, sheet.name.offshore,
                         col.types.inshore, col.types.offshore,
                         col.names.inshore, col.names.offshore,
                         Year, 
                         xls.file.name.inshore, xls.file.name.offshore,
                         start.time)

if (save.files){
  # Creates file names and saves files
  files <- file.names(out.dir, Year, out.list)
  
}


```



## 2016

```{r}
# Offshore:
# Row 207 TIME = 110. Changed to 1100. 2023-05-09

Year <- 2016
dir.name <- paste0("C_C ", Year)
start.time <- "700"
xls.files <- list.files(path = paste0(data.dir, dir.name), pattern = ".xls")
xls.file.name.inshore <- paste0(data.dir, dir.name, "/", xls.files[grep("INSHORE", xls.files)])
xls.file.name.offshore <- paste0(data.dir, dir.name, "/", xls.files[grep("OFFSHORE", xls.files)])

sheet.name.inshore <- "LOGS"
sheet.name.offshore <- NULL

col.names.inshore <- c("DATE",	"EVENT", 	"TIME",	"OBS#",
                       "VIS IN",	"SEA ST",	"C/C", "IN/OFF")

col.types.inshore <- c("date", "numeric", "text", "numeric", 
                       "text", "text", "numeric", "numeric", 
                       "text", "text", "text", "text", 
                       "text", "text", "text")

col.names.offshore <- c("DATE",	"EVENT",	"TIME",	"OBS",	
                        "VIS",	"SEA ST",	"C/C")

col.types.offshore <- c("date", "numeric", "text", "numeric", 
                        "text", "text", "numeric", "numeric", 
                        "text", "text",  "text", "text")

out.list <- get.all.data(sheet.name.inshore, sheet.name.offshore,
                         col.types.inshore, col.types.offshore,
                         col.names.inshore, col.names.offshore,
                         Year, 
                         xls.file.name.inshore, xls.file.name.offshore,
                         start.time)

if (save.files){
  # Creates file names and saves files
  files <- file.names(out.dir, Year, out.list)
  
}


```


## 2017

No offshore log exists for 2017
```{r}
# Inshore:
# Row 29: TIME = 83o. Changed to 830. 2023-05-09

Year <- 2017
dir.name <- paste0("C_C ", Year)
start.time <- "0700"
xls.files <- list.files(path = paste0(data.dir, dir.name), pattern = ".xls")
xls.file.name.inshore <- paste0(data.dir, dir.name, "/", xls.files[1])

sheet.name <- "LOGS"

col.names <- c("DATE",	"EVENT", 	"TIME",	"OBS#",
               "VIS IN",	"SEA ST",	"C/C", "IN/OFF")

col.types <- c("date", "numeric", "text", "text", 
               "text", "text", "numeric", "numeric", 
               "text", "text", "text", "text", 
               "text", "text", "text", "text",
               "text", "text")

# get the data using get.data function, which is in Piedras_Blancas_fcns.R
data.inshore <- get.data(Year = Year,
                     xls.file.name = xls.file.name.inshore,
                     sheet.name = sheet.name,
                     col.types = col.types,
                     col.names = all_of(col.names),
                     start.time = start.time) %>%
  extract.all.vars()

# calculate effort and other statistics per 3-hr shift, using find.effort
# function in Piedras_Blancas_fcns.R
data.shift <- find.effort(data.inshore, T0 = start.time) #%>% extract.shift.vars()

formatted.inshore <- format.output(data.shift$out.df, 
                                   max.shift = max(data.shift$out.df$Shift))

out.list <- list(data.offshore = NULL,
                 data.inshore = data.inshore,
                 shift.data.offshore = NULL,
                 shift.data.inshore = data.shift$out.df,
                 formatted.data.offshore = NULL,
                 formatted.data.inshore = formatted.inshore)

if (save.files){
  # Creates file names and saves files
  files <- file.names(out.dir, Year, out.list)
  
}



```



## 2018

No offshore log exists for 2018
```{r}
Year <- 2018
dir.name <- paste0("C_C ", Year)
start.time <- "700"
xls.files <- list.files(path = paste0(data.dir, dir.name), pattern = ".xls")
xls.file.name.inshore <- paste0(data.dir, dir.name, "/", xls.files[1])

sheet.name <- "LOGS"

col.names <- c("DATE",	"EVENT", 	"TIME",	"OBS#",
               "VIS IN",	"SEA ST",	"C/C", "IN/OFF")

col.types <- c("numeric", "date", "numeric", "text", "text", 
               "text", "text", "numeric", "numeric", 
               "text", "text", "text", "text", 
               "text", "text", "text", "text",
               "text", "text", "text", "text")

# get the data using get.data function, which is in Piedras_Blancas_fcns.R
data.inshore <- get.data(Year = Year,
                     xls.file.name = xls.file.name.inshore,
                     sheet.name = sheet.name,
                     col.types = col.types,
                     col.names = all_of(col.names),
                     start.time = start.time) %>%
  extract.all.vars()

# calculate effort and other statistics per 3-hr shift, using find.effort
# function in Piedras_Blancas_fcns.R
data.shift <- find.effort(data.inshore, T0 = start.time) #%>% extract.shift.vars()

formatted.inshore <- format.output(data.shift$out.df, 
                                   max.shift = max(data.shift$out.df$Shift))

out.list <- list(data.offshore = NULL,
                 data.inshore = data.inshore,
                 shift.data.offshore = NULL,
                 shift.data.inshore = data.shift$out.df,
                 formatted.data.offshore = NULL,
                 formatted.data.inshore = formatted.inshore)


if (save.files){
  # Creates file names and saves files
  files <- file.names(out.dir, Year, out.list)
  
}


```





## 2019

No offshore log exists for 2019
```{r}
# Event for 4/29/2019 at 1845 was changed from "1" to "4". 2022-06-24
# Event for 5/9/2019 at 0830 was changed from "1" to "3". 2022-06-24
# Event for 5/23/2019 at 1200 was changed from "1" to "3". 2022-06-24

Year <- 2019
dir.name <- paste0("C_C ", Year)
start.time <- "700"

xls.files <- list.files(path = paste0(data.dir, dir.name), pattern = ".xls")
xls.file.name.inshore <- paste0(data.dir, dir.name, "/", xls.files[1])

sheet.name <- "INSHORE LOGS"

col.names <- c("DATE",	"EVENT", 	"TIME",	"OBS #",
               "VIS IN",	"SEA ST",	"C/C", "IN/OFF")

col.types <- c("date", "numeric", "numeric", "text", "text", 
               "text", "text", "numeric", "numeric", 
               "text", "text", "text", "text", 
               "text", "text", "text", "text",
               "text", "text", "text")

# get the data using get.data function, which is in Piedras_Blancas_fcns.R
data.inshore <- get.data(Year = Year,
                     xls.file.name = xls.file.name.inshore,
                     sheet.name = sheet.name,
                     col.types = col.types,
                     col.names = all_of(col.names),
                     start.time = start.time) %>%
  extract.all.vars()

# calculate effort and other statistics per 3-hr shift, using find.effort
# function in Piedras_Blancas_fcns.R
data.shift <- find.effort(data.inshore, T0 = start.time) #%>% extract.shift.vars()

formatted.inshore <- format.output(data.shift$out.df, 
                                   max.shift = max(data.shift$out.df$Shift))

out.list <- list(data.offshore = NULL,
                 data.inshore = data.inshore,
                 shift.data.offshore = NULL,
                 shift.data.inshore = data.shift$out.df,
                 formatted.data.offshore = NULL,
                 formatted.data.inshore = formatted.inshore)

if (save.files){
  # Creates file names and saves files
  files <- file.names(out.dir, Year, out.list)
  
}


```


No data for 2020 - COVID.

## 2021

```{r}
# Event for 4/20/2021 at 745 was changed from "3" to "5". 2022-06-24
Year <- 2021
dir.name <- paste0("C_C ", Year)
start.time <- "700"
xls.files <- list.files(path = paste0(data.dir, dir.name), pattern = ".xls")
xls.file.name.inshore <- paste0(data.dir, dir.name, "/", xls.files[1])

sheet.name <- "INSHORE LOGS"

col.names <- c("DATE",	"EVENT", 	"TIME",	"OBS #",
                       "VIS IN",	"SEA ST",	"C/C", "IN/OFF")

col.types <- c("date", "numeric", "numeric", "text", "text", 
               "text", "text", "numeric", "numeric", 
               "text", "text", "text", "text", 
               "text", "text", "text", "text",
               "text", "text", "text", "text", "text")

# get the data using get.data function, which is in Piedras_Blancas_fcns.R
data.inshore <- get.data(Year = Year,
                     xls.file.name = xls.file.name.inshore,
                     sheet.name = sheet.name,
                     col.types = col.types,
                     col.names = all_of(col.names),
                     start.time = start.time) %>%
  extract.all.vars()

# calculate effort and other statistics per 3-hr shift, using find.effort
# function in Piedras_Blancas_fcns.R
data.shift <- find.effort(data.inshore, T0 = start.time) #%>% extract.shift.vars()

formatted.inshore <- format.output(data.shift$out.df, 
                                   max.shift = max(data.shift$out.df$Shift))

out.list <- list(data.offshore = NULL,
                 data.inshore = data.inshore,
                 shift.data.offshore = NULL,
                 shift.data.inshore = data.shift$out.df,
                 formatted.data.offshore = NULL,
                 formatted.data.inshore = formatted.inshore)


if (save.files){
  # Creates file names and saves files
  files <- file.names(out.dir, Year, out.list)
  
}


```


## 2022


```{r}
# PROBLEM WITH AT LEAST ONE SHIFT 2022-03-28 ENDING/STARTING AT NOT EXACTLY AT THE 
# TOP OF THE HOUR (1558 INSTEAD OF 1600). THIS SHOULD BE EDITED IN THE DATA FILE. 
# CONTINUE HERE 2022-06-22  -> IT HAS BEEN EDITED TO 1600 2022-06-23

Year <- 2022
dir.name <- paste0("C_C ", Year)
start.time <- "700"
xls.files <- list.files(path = paste0(data.dir, dir.name), pattern = ".xls")
xls.file.name.inshore <- paste0(data.dir, dir.name, "/", xls.files[1])

sheet.name <- "MomCalf Logs 2022 postQC"
# c("Date", "Event", "Time", "Obs. Code", 
#  "Sea State", "Vis. IN", "Cow  / Calf")

# These are not the names of all columns. These are the names of columns in the
# spreadsheet that are needed. These names change among years, so they need to
# be specified for each year.
col.names <- c("DATE", 	"EVENT", 	"TIME",	"OBS #",
               "SEA ST", "VIS IN", "M/C", "LOCATION (IN/OFF)")

# these are column types of all columns in the spreadsheet. 
col.types <- c("date", "numeric", "numeric", "text", "text", 
               "text", "text", "numeric", "numeric", "text", 
               "text", "text", "text", "numeric", "text", 
               "text", "text", "text")

# get the data using get.data function, which is in Piedras_Blancas_fcns.R
data.inshore <- get.data(Year = Year,
                     xls.file.name = xls.file.name.inshore,
                     sheet.name = sheet.name,
                     col.types = col.types,
                     col.names = all_of(col.names),
                     start.time = start.time) %>%
  extract.all.vars()

# calculate effort and other statistics per 3-hr shift, using find.effort
# function in Piedras_Blancas_fcns.R
data.shift <- find.effort(data.inshore, T0 = start.time) #%>% extract.shift.vars()

formatted.inshore <- format.output(data.shift$out.df, 
                                   max.shift = max(data.shift$out.df$Shift))

out.list <- list(data.offshore = NULL,
                 data.inshore = data.inshore,
                 shift.data.offshore = NULL,
                 shift.data.inshore = data.shift$out.df,
                 formatted.data.offshore = NULL,
                 formatted.data.inshore = formatted.inshore)

if (save.files){
  # Creates file names and saves files
  files <- file.names(out.dir, Year, out.list)
  
}


```

